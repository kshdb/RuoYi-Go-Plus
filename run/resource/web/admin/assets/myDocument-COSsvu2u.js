var u=(l,d,o)=>new Promise((g,y)=>{var h=n=>{try{c(o.next(n))}catch(f){y(f)}},p=n=>{try{c(o.throw(n))}catch(f){y(f)}},c=n=>n.done?g(n.value):Promise.resolve(n.value).then(h,p);c((o=o.apply(l,d)).next())});import{P as R}from"./index-DrfqwNLV.js";import{_ as V}from"./index-CwwL6bPg.js";import{a as v}from"./index-HlBkaR6C.js";import{i as P,c as D,e as N}from"./index-CU-vYa55.js";import{u as T,_ as F}from"./useTable-BlleqRm-.js";import{_ as w}from"./index-Rv_3g2e8.js";import{u as B}from"./useRender-C6p2srTi.js";import{D as K}from"./dictEnum-DeC8h6ZR.js";import{bp as W,bj as $,bq as A,c as L,I as b,j as U}from"./entry/index-CMepwc5X-1716790511191.js";import{at as q,au as S,y as M}from"./antd-BRjMhd0C.js";import{d as j,f as I,r as z,o as G,_,a8 as k,a9 as m,k as r,u as a,ad as H,ac as x,al as J,am as O,$ as Q,F as X}from"./vue-Bw3NQgLF.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./index-CMSTH4sS.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./index-BhefpKLc.js";import"./dict-C9gNHjAh.js";const{renderDict:Y}=B(),Z=[{dataIndex:"processDefinitionName",title:"流程名称"},{dataIndex:"processDefinitionKey",title:"流程key"},{dataIndex:"processDefinitionVersion",title:"版本号",customRender({value:l}){return`V${l}.0`}},{dataIndex:"businessStatus",title:"流程状态",customRender({value:l}){return Y(l,K.WF_BUSINESS_STATUS)}},{dataIndex:"startTime",title:"启动时间"}],ee=[{field:"name",label:"流程名称",component:"Input"}],te=j({__name:"myDocument",setup(l){const d=I(""),o=z({tree:[],selectId:[]}),g=I(!0);function y(){return u(this,null,function*(){yield p()})}G(()=>u(this,null,function*(){const e=yield v();let t=W(e,{id:"id",pid:"parentId"});t=[{categoryName:"根目录",id:0,children:t}],$(t,i=>{i.icon="flat-color-icons:folder"}),A(t,"categoryName"," / "),o.tree=t,g.value=!1}));const[h,{reload:p}]=T({rowSelection:{type:"checkbox"},title:"我发起的流程列表",showIndexColumn:!1,api:P,rowKey:"id",useSearchForm:!0,formConfig:{schemas:ee,baseColProps:{xs:24,sm:24,md:24,lg:6},labelWidth:80,resetFunc:()=>u(this,null,function*(){o.selectId=[],d.value=""})},columns:Z,beforeFetch(e){return o.selectId.length===1&&(e.categoryCode=o.selectId[0]),e},actionColumn:{width:220,title:"操作",key:"action",fixed:"right"}}),c=L();function n(e){const t=e.wfNodeConfigVo.wfFormManageVo.router;c({path:t,query:{id:e.businessKey,type:"preview"}})}function f(e){return u(this,null,function*(){yield D(e.id),yield p()})}function C(e){const t=e.wfNodeConfigVo.wfFormManageVo.router;c({path:t,query:{id:e.businessKey,type:"update"}})}function E(e){return u(this,null,function*(){yield N([e.id]),yield p()})}return(e,t)=>(_(),k(a(R),{dense:""},{default:m(()=>[r(a(q),null,{default:m(()=>[r(a(S),H({xs:24,sm:24,md:24,lg:4},{class:"h-[calc(100vh-80px)]"}),{default:m(()=>[r(a(M),{active:!0,paragraph:{rows:8},loading:g.value},{default:m(()=>[o.tree.length?(_(),k(a(V),{key:0,fieldNames:{title:"categoryName",key:"categoryCode"},"tree-data":o.tree,showLine:{showLeafIcon:!1},search:!0,searchValue:d.value,"onUpdate:searchValue":t[0]||(t[0]=i=>d.value=i),defaultExpandAll:"",onSelect:y,selectedKeys:o.selectId,"onUpdate:selectedKeys":t[1]||(t[1]=i=>o.selectId=i)},null,8,["tree-data","searchValue","selectedKeys"])):x("",!0)]),_:1},8,["loading"])]),_:1},16),r(a(S),J(O({xs:24,sm:24,md:24,lg:20})),{default:m(()=>[r(a(F),{onRegister:a(h)},{bodyCell:m(({column:i,record:s})=>[i.key==="action"?(_(),Q(X,{key:0},[r(a(w),{stopButtonPropagation:"",actions:[{label:"审批记录",icon:a(b).PREVIEW,onClick:n.bind(null,s)},{label:"重新提交",icon:a(b).PREVIEW,onClick:C.bind(null,s),ifShow:s.businessStatus==="draft"||s.businessStatus==="cancel"||s.businessStatus==="back"}]},null,8,["actions"]),r(a(w),{stopButtonPropagation:"",actions:[{label:"删除",icon:a(b).PREVIEW,danger:!0,popConfirm:{title:"是否确认删除",confirm:E.bind(null,s)},ifShow:s.businessStatus==="draft"||s.businessStatus==="cancel"||s.businessStatus==="back"},{label:"撤销",icon:a(b).DELETE,danger:!0,popConfirm:{placement:"left",title:`是否确认撤销[${s.processDefinitionName}]流程?`,confirm:f.bind(null,s)},ifShow:s.businessStatus==="waiting"}]},null,8,["actions"])],64)):x("",!0)]),_:1},8,["onRegister"])]),_:1},16)]),_:1})]),_:1}))}}),De=U(te,[["__scopeId","data-v-2097bd64"]]);export{De as default};
