var f=(b,v,p)=>new Promise((g,e)=>{var n=t=>{try{i(p.next(t))}catch(u){e(u)}},m=t=>{try{i(p.throw(t))}catch(u){e(u)}},i=t=>t.done?g(t.value):Promise.resolve(t.value).then(n,m);i((p=p.apply(b,v)).next())});import{d as W,c as h,ao as j,f as _,o as A,a7 as E,Z as d,a8 as k,a9 as c,k as l,m as I,A as R,u as a,ab as y,_ as P,G as Y}from"./vue-Cw15aJ-2.js";import{u as G,_ as q}from"./useForm-BsovIqMX.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./componentMap-qA-f8iV4.js";import{m as O}from"./leave.data-EdLlua-d.js";import{P as U}from"./index-C4nZBquz.js";import{g as Z,u as z,a as H}from"./api-o0nwNarG.js";import{j as T,k as J,C as B}from"./entry/index-BbJQUQ84-1718268303552.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-tbsKhTM1.js";import{u as X}from"./index-BIkrAlj7.js";import{s as ee}from"./index-DH8S7RKQ.js";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang-DuvhP-Bt.js";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-CTFjNtYq.js";import oe from"./Preview-Cwf6OezZ.js";import{y as se,o as re}from"./antd-DMGzOvrA.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./helper-CXVLNTBN.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./index-DCvxWw7W.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./copyTextToClipboard-uEEWQikS.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./style-CLEvKZSv.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./dict-vVDMuEaq.js";import"./dictEnum-DeC8h6ZR.js";import"./useContentViewHeight-BDi3O9lC.js";import"./index-BsD3RzB-.js";import"./index-BcLdq1Bd.js";import"./index-Bys7JeoU.js";import"./useTable-CNbfTOCZ.js";import"./sortable.esm-DFFrMEeC.js";import"./index-m3nShAF-.js";import"./index-Dwl0vFWZ.js";import"./index-BQijfeh-.js";import"./index-DeqOXDrL.js";import"./RejectModal.vue_vue_type_script_setup_true_lang-BLpwfAdl.js";import"./DeleteMultiInstanceModal-B4C_d8R1.js";import"./index-UH6lRBqh.js";import"./index-BVlzXcPd.js";import"./useDescription-DLkhA-M6.js";const ie={key:0,class:"flex justify-end gap-8px mt-8px"},le={key:2},et=W({__name:"LeaveFormTest",setup(b){const v=h(()=>e.type==="add"||e.type==="update"),p=h(()=>e.type==="preview"||e.type==="approval"),e=j().query,n=_(""),m=_(),i=_(!1);A(()=>f(this,null,function*(){i.value=!0;const{type:s,id:r=""}=e;if(s){if(s==="preview"||s==="update"||s==="approval"){yield K({disabled:s==="preview"||s==="approval"});const o=yield Z(r);n.value=o.id,m.value=o,o.dateTime=[T(o.startDate),T(o.endDate)],yield F(o)}i.value=!1}}));const t=_(!1),[u,{setFieldsValue:F,validate:$,setProps:K}]=G({labelWidth:100,name:"leave_form",showActionButtonGroup:!1,baseColProps:{xs:24,sm:24,md:24,lg:12},schemas:O,fieldMapToTime:[["dateTime",["startDate","endDate"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 00:00:00"]]]}),{closeCurrent:D}=J(),[L,{openModal:N}]=X();function C(s){return f(this,null,function*(){try{t.value=!0;const r=yield $(),o=re(r,"version"),w=yield(e.type==="update"?z:H)(o);if(s==="temp"){yield D();return}const S={businessKey:w.id,tableName:"test_leave",variables:{entity:w,leaveDays:w.leaveDays,userList:[1,3],userList2:[1,3]}},V=yield ee(S);N(!0,V.taskId)}catch(r){}finally{t.value=!1}})}function M(){return f(this,null,function*(){yield D()})}return(s,r)=>{const o=E("a-button");return d(),k(a(U),{dense:"",contentClass:"p-16px"},{default:c(()=>[l(a(B),{title:"表单信息"},{default:c(()=>[I(l(a(se),{active:""},null,512),[[R,i.value]]),I(l(a(q),{onRegister:a(u)},null,8,["onRegister"]),[[R,!i.value&&v.value]]),m.value&&p.value?(d(),k(a(oe),{key:0,data:m.value},null,8,["data"])):y("",!0)]),_:1}),v.value?(d(),P("div",ie,[l(o,{loading:t.value,disabled:t.value,onClick:r[0]||(r[0]=x=>C("temp"))},{default:c(()=>[Y("保存草稿")]),_:1},8,["loading","disabled"]),l(o,{loading:t.value,disabled:t.value,type:"primary",onClick:r[1]||(r[1]=x=>C("submit"))},{default:c(()=>[Y("提交")]),_:1},8,["loading","disabled"])])):y("",!0),a(e).type==="approval"&&a(e).taskId?(d(),k(a(B),{key:1,class:"mt-16px",title:"审批"},{default:c(()=>[l(ae,{class:"md:w-full lg:w-1/2",taskId:a(e).taskId,onReload:M},null,8,["taskId"])]),_:1})):y("",!0),p.value&&n.value?(d(),P("div",le,[l(te,{businessKey:n.value},null,8,["businessKey"])])):y("",!0),l(Q,{approvalMode:a(e).type==="approval",taskId:a(e).taskId,onRegister:a(L),onReload:M},null,8,["approvalMode","taskId","onRegister"])]),_:1})}}});export{et as default};
