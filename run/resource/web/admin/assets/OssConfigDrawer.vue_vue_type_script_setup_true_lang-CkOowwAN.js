var m=(a,s,n)=>new Promise((i,c)=>{var p=e=>{try{t(n.next(e))}catch(l){c(l)}},u=e=>{try{t(n.throw(e))}catch(l){c(l)}},t=e=>e.done?i(e.value):Promise.resolve(e.value).then(p,u);t((n=n.apply(a,s)).next())});import{a as _,B as P}from"./index-ov0mgIjt.js";import{u as v,_ as C}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{c as D,d as y,e as O}from"./config-D-gR7Hbj.js";import{g as q}from"./dict-C9gNHjAh.js";import{D as B}from"./dictEnum-DeC8h6ZR.js";import{u as x}from"./useSize-tRF5RUOv.js";import{d as S,f as k,c as R,_ as F,a8 as K,a9 as N,k as V,u as r,ad as W}from"./vue-Bw3NQgLF.js";const A=[{label:"private",value:"0",color:"orange"},{label:"public",value:"1",color:"green"},{label:"custom",value:"2",color:"blue"}],G=[{label:"id",field:"ossConfigId",component:"Input",show:!1},{label:"基本信息",field:"baseInfo",component:"Divider",componentProps:{orientation:"center"}},{label:"配置名称",field:"configKey",component:"Input",required:!0},{label:"服务地址",field:"endpoint",component:"Input",helpMessage:"这里不需要填写http/https!!!, 加上无法预览/下载文件",rules:[{required:!0,message:"请输入服务地址",trigger:"blur"},{message:"不需要填写http(s)",trigger:"blur",validator:(a,s)=>s&&s.startsWith("http")?Promise.reject():Promise.resolve()}],componentProps({formModel:a}){return{addonBefore:a.isHttps==="Y"?"https://":"http://"}}},{label:"自定义域名",field:"domain",component:"Input",rules:[{required:!1,message:"不需要带http/https协议",trigger:"blur"}]},{label:"认证信息",field:"accessInfo",component:"Divider",componentProps:{orientation:"center"}},{label:"accessKey",field:"accessKey",component:"Input",required:!0},{label:"secretKey",field:"secretKey",component:"Input",required:!0},{label:"其他信息",field:"otherInfo",component:"Divider",componentProps:{orientation:"center"}},{label:"桶名称",field:"bucketName",component:"Input",required:!0},{label:"前缀",field:"prefix",component:"Input"},{label:"权限桶类型",field:"accessPolicy",component:"RadioButtonGroup",required:!0,defaultValue:"0",componentProps:{options:A},colProps:{xs:24,sm:24,md:24,lg:12}},{label:"是否https",field:"isHttps",component:"RadioButtonGroup",required:!0,defaultValue:"N",componentProps:{options:q(B.YES_NO)},colProps:{xs:24,sm:24,md:24,lg:{span:10,offset:2}}},{label:"域",field:"region",component:"Input"},{label:"备注",field:"remark",component:"InputTextArea"}],J=S({name:"OssConfigDrawer",__name:"OssConfigDrawer",emits:["register","reload"],setup(a,{emit:s}){const n=s,i=k(!1),c=x(700),p=R(()=>i.value?"编辑OSS配置":"新增OSS配置"),[u,{drawerLoading:t,closeDrawer:e}]=_(o=>m(this,null,function*(){t(!0);const{record:d,update:g}=o;if(i.value=g,g&&d){const I=yield D(d.ossConfigId);yield b(I)}t(!1)})),[l,{setFieldsValue:b,resetForm:f,validate:h}]=v({labelWidth:100,name:"oss_config_drawer",showActionButtonGroup:!1,baseColProps:{span:24},schemas:G});function w(){return m(this,null,function*(){try{t(!0);const o=yield h();r(i)?yield y(o):yield O(o),n("reload"),e(),yield f()}catch(o){}finally{t(!1)}})}return(o,d)=>(F(),K(r(P),W(o.$attrs,{title:p.value,width:r(c),showFooter:!0,onRegister:r(u),onOk:w,onClose:r(f)}),{default:N(()=>[V(r(C),{onRegister:r(l)},null,8,["onRegister"])]),_:1},16,["title","width","onRegister","onClose"]))}});export{J as _};
