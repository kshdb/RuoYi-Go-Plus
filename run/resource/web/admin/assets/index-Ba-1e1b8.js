var l=(y,t,a)=>new Promise((u,r)=>{var p=e=>{try{n(a.next(e))}catch(i){r(i)}},d=e=>{try{n(a.throw(e))}catch(i){r(i)}},n=e=>e.done?u(e.value):Promise.resolve(e.value).then(p,d);n((a=a.apply(y,t)).next())});import{P as T}from"./index-DrfqwNLV.js";import{u as D,_ as S}from"./useTable-BlleqRm-.js";import{_ as $}from"./index-Rv_3g2e8.js";import{r as P,a as B,b as V}from"./index-CYdIkwig.js";import{i as E,I as K,h as L}from"./entry/index-CMepwc5X-1716790511191.js";import{f as M,c as F,_ as G}from"./AssignRolesDrawer.vue_vue_type_script_setup_true_lang-BAF6Nk9U.js";import{d as O,f as W,ao as j,aa as q,n as z,_ as m,a8 as c,a9 as s,k as h,G as C,m as k,u as o,ac as H}from"./vue-Bw3NQgLF.js";import{u as J}from"./index-ov0mgIjt.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./antd-BRjMhd0C.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./index-CMSTH4sS.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./dict-C9gNHjAh.js";import"./dictEnum-DeC8h6ZR.js";import"./useSize-tRF5RUOv.js";const ve=O({name:"AssignRoles",__name:"index",setup(y){const t=W("0"),a=j();t.value=a.params.roleId;const[u,{reload:r,getSelectRowKeys:p,selected:d}]=D({rowSelection:{type:"checkbox"},title:"已分配的用户列表",showIndexColumn:!1,clickToRowSelect:!0,api:P,rowKey:"userId",useSearchForm:!0,formConfig:{schemas:M,baseColProps:{xs:24,sm:24,md:24,lg:6}},searchInfo:{roleId:t.value},columns:F,actionColumn:{title:"操作",key:"action",fixed:"right"}}),[n,{openDrawer:e}]=J();function i(){e(!0,{})}const{createConfirm:I}=L();function R(){I({iconType:"warning",title:"取消授权",content:"是否取消选中的授权?",onOk(){return l(this,null,function*(){const g=p();yield B(t.value,g),yield r()})}})}function v(w){return l(this,null,function*(){yield V({userId:w.userId,roleId:t.value}),yield r()})}const{closeCurrent:x}=E();function A(){return l(this,null,function*(){yield x()})}return(w,g)=>{const f=q("a-button"),b=z("auth");return m(),c(o(T),{dense:""},{default:s(()=>[h(o(S),{onRegister:o(u)},{toolbar:s(()=>[h(f,{onClick:A},{default:s(()=>[C("关闭页面")]),_:1}),k((m(),c(f,{disabled:!o(d),type:"error",onClick:R},{default:s(()=>[C("取消授权")]),_:1},8,["disabled"])),[[b,"system:role:edit"]]),k((m(),c(f,{type:"primary",onClick:i},{default:s(()=>[C("添加")]),_:1})),[[b,"system:role:edit"]])]),bodyCell:s(({column:N,record:_})=>[N.key==="action"?(m(),c(o($),{key:0,stopButtonPropagation:"",actions:[{label:"取消授权",icon:o(K).CANCEL,auth:"system:role:edit",popConfirm:{placement:"left",title:`是否取消授权用户[${_.userName} - ${_.nickName}]?`,confirm:v.bind(null,_)}}]},null,8,["actions"])):H("",!0)]),_:1},8,["onRegister"]),h(G,{onRegister:o(n),onReload:o(r)},null,8,["onRegister","onReload"])]),_:1})}}});export{ve as default};
