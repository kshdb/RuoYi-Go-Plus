var m=(C,b,s)=>new Promise((k,u)=>{var _=n=>{try{l(s.next(n))}catch(c){u(c)}},r=n=>{try{l(s.throw(n))}catch(c){u(c)}},l=n=>n.done?k(n.value):Promise.resolve(n.value).then(_,r);l((s=s.apply(C,b)).next())});import{P as x}from"./index-DrfqwNLV.js";import{g as M,p as O,u as B,c as K}from"./index-CigIE-O6.js";import{u as P,_ as E}from"./useTable-BlleqRm-.js";import{_ as I}from"./index-Rv_3g2e8.js";import{columns as L}from"./definition.data-DAtQVa5l.js";import{i as V,I as d,h as W}from"./entry/index-CMepwc5X-1716790511191.js";import{d as z,ao as A,o as F,aa as G,_ as f,a8 as y,a9 as g,k as T,G as $,a1 as v,ac as w,u as i}from"./vue-Bw3NQgLF.js";import{u as H}from"./index-CMSTH4sS.js";import{_ as U}from"./PreviewModal.vue_vue_type_script_setup_true_lang-ayK0IOb0.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./antd-BRjMhd0C.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./dict-C9gNHjAh.js";import"./index-Cvdu3VMw.js";import"./index-u_3lW7KD.js";import"./index-CU-vYa55.js";const $t=z({name:"WorkflowDefinitionHistoryPage",__name:"index",emits:["register","preview"],setup(C){const s=A().params.key||"0";console.log(s),F(()=>m(this,null,function*(){yield r()}));const[k,{setTableData:u}]=P({showIndexColumn:!1,rowKey:"id",useSearchForm:!1,columns:L,actionColumn:{width:300,title:"操作",key:"action",fixed:"right"},showTableSetting:!1,pagination:!1,inset:!0,size:"small"}),{setTitle:_}=V();function r(){return m(this,null,function*(){const t=yield M(s);if(u(t),t&&t.length){const{name:a}=t[0];_("历史记录: "+a)}})}const{createConfirm:l}=W();function n(t){return m(this,null,function*(){l({iconType:"warning",title:"提示",content:`是否确认删除[${t.name}] - [${t.key}]`,onOk:()=>m(this,null,function*(){const{deploymentId:a,id:p}=t;yield O(a,p),yield r()})})})}function c(t){const a=t.suspensionState=="1"?"暂停":"启动",p=t.suspensionState=="1"?"不允许":"允许",o=t.suspensionState=="1"?"挂起":"激活";l({iconType:"warning",title:"提示",content:`${a}后，此流程下的所有任务都${p}往后流转，您确定${o}【${t.name}】吗？`,onOk:()=>m(this,null,function*(){yield B(t.id),yield r()})})}function S(t){l({iconType:"info",title:"提示",content:`是否确认转换为模型[${t.name}] - [${t.key}]`,onOk:()=>m(this,null,function*(){yield K(t.id),yield r()})})}const[D,{openModal:N}]=H();function h(t,a){N(!0,{type:t,id:a.id})}return(t,a)=>{const p=G("a-button");return f(),y(i(x),null,{default:g(()=>[T(i(E),{onRegister:i(k)},{bodyCell:g(({column:o,record:e})=>[o&&e&&o.key==="resourceName"?(f(),y(p,{key:0,type:"link",onClick:R=>h("xml",e)},{default:g(()=>[$(v(e.resourceName),1)]),_:2},1032,["onClick"])):w("",!0),o&&e&&o.key==="diagramResourceName"?(f(),y(p,{key:1,type:"link",onClick:R=>h("image",e)},{default:g(()=>[$(v(e.diagramResourceName),1)]),_:2},1032,["onClick"])):w("",!0),o&&e&&o.key==="action"?(f(),y(i(I),{key:2,stopButtonPropagation:"",dropDownBtnDisplay:"",actions:[{label:e.suspensionState==1?"挂起流程":"激活流程",icon:e.suspensionState==1?i(d).LOCK:i(d).UNLOCK,onClick:c.bind(null,e)},{label:"转换模型",icon:"lets-icons:transger",onClick:S.bind(null,e)},{label:"删除",icon:i(d).DELETE,danger:!0,onClick:n.bind(null,e)}]},null,8,["actions"])):w("",!0)]),_:1},8,["onRegister"]),T(U,{onRegister:i(D)},null,8,["onRegister"])]),_:1})}}});export{$t as default};
