var D=(k,l,s)=>new Promise((f,c)=>{var h=o=>{try{p(s.next(o))}catch(m){c(m)}},b=o=>{try{p(s.throw(o))}catch(m){c(m)}},p=o=>o.done?f(o.value):Promise.resolve(o.value).then(h,b);p((s=s.apply(k,l)).next())});import{P}from"./index-C4nZBquz.js";import{u as M,_ as N}from"./useTable-CNbfTOCZ.js";import{_ as B}from"./index-DCvxWw7W.js";import{m as F,d as L}from"./index-CCBbV1HU.js";import{b as R,bw as V,bA as q,i as G,I as _}from"./entry/index-BbJQUQ84-1718268303552.js";import{t as H,f as K}from"./menu.data-CGB81tOC.js";import{_ as O}from"./MenuDrawer.vue_vue_type_script_setup_true_lang-nd4IlTDU.js";import{u as U}from"./index-BLDmWVyR.js";import{aa as W,T as Z,a6 as j,aq as z}from"./antd-DMGzOvrA.js";import{d as J,a7 as Q,n as X,Z as y,a8 as C,a9 as n,k as r,u as a,ad as Y,H as ee,G as g,m as te,ab as ae}from"./vue-Cw15aJ-2.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./index-BIkrAlj7.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";import"./dict-vVDMuEaq.js";import"./dictEnum-DeC8h6ZR.js";import"./useSize-CUNtmCvH.js";const Ne=J({name:"Menu",__name:"index",setup(k){const l=R("refreshMenu",!0),s=R("__menu_tip_read",!1),[f,{getRawDataSource:c,expandRows:h,collapseRows:b,expandAll:p,collapseAll:o,reload:m}]=M({title:"菜单列表",bordered:!1,api:F,rowKey:"menuId",isTreeTable:!0,columns:H,useSearchForm:!0,formConfig:{baseColProps:{xs:24,sm:24,md:12,lg:6},name:"menu",schemas:K},pagination:!1,afterFetch(t){const e=V(t,{id:"menuId",pid:"parentId"});return q(e),e},actionColumn:{width:230,title:"操作",key:"action",fixed:"right"}}),[A,{openDrawer:w}]=U();function T(t){w(!0,{record:t,update:!0})}function x(t){const e=t?t.menuId:0;w(!0,{record:{parentId:e},update:!1})}const{refreshMenu:E}=G();function I(t){return D(this,null,function*(){yield L([t.menuId]),yield m(),l.value&&(yield E())})}function v(t){const e=c();if(e instanceof Array)switch(t){case"expandAll":e.forEach(i=>{i.expand=!0}),p();break;case"collapseAll":e.forEach(i=>{i.expand=!1}),o();break}}function S(t){const{menuId:e}=t;t.expand===!0?(b([e]),t.expand=!1):(h([e]),t.expand=!0)}return(t,e)=>{const i=Q("a-button"),$=X("auth");return y(),C(a(P),{dense:""},{default:n(()=>[r(a(N),{onRegister:a(f),onRowDbClick:S},Y({toolbar:n(()=>[r(a(W),null,{default:n(()=>[r(a(Z),{title:"修改后是否刷新菜单栏"},{default:n(()=>[r(a(j),{checked:a(l),"onUpdate:checked":e[1]||(e[1]=u=>ee(l)?l.value=u:null)},null,8,["checked"])]),_:1}),r(i,{class:"<sm:hidden",onClick:e[2]||(e[2]=u=>v("expandAll"))},{default:n(()=>[g("展开")]),_:1}),r(i,{class:"<sm:hidden",onClick:e[3]||(e[3]=u=>v("collapseAll"))},{default:n(()=>[g("折叠")]),_:1}),te((y(),C(i,{type:"primary",onClick:x},{default:n(()=>[g("新增")]),_:1})),[[$,"system:menu:add"]])]),_:1})]),bodyCell:n(({column:u,record:d})=>[u.key==="action"?(y(),C(a(B),{key:0,stopButtonPropagation:"",actions:[{label:"修改",type:"primary",ghost:!0,icon:a(_).EDIT,onClick:T.bind(null,d),auth:"system:menu:edit"},{label:"新增",icon:a(_).ADD,type:"primary",color:"success",ghost:!0,onClick:x.bind(null,d),auth:"system:menu:add",ifShow:d.menuType!=="F"},{label:"删除",icon:a(_).DELETE,type:"primary",ghost:!0,danger:!0,auth:"system:menu:delete",popConfirm:{title:`是否删除菜单[${d.menuName}]?`,placement:"left",confirm:I.bind(null,d)}}]},null,8,["actions"])):ae("",!0)]),_:2},[a(s)?void 0:{name:"headerTop",fn:n(()=>[r(a(z),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=u=>s.value=!0)})]),key:"0"}]),1032,["onRegister"]),r(O,{onRegister:a(A),onReload:a(m)},null,8,["onRegister","onReload"])]),_:1})}}});export{Ne as default};
