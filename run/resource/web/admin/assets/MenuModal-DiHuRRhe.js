var l=(h,c,r)=>new Promise((s,u)=>{var p=e=>{try{o(r.next(e))}catch(i){u(i)}},f=e=>{try{o(r.throw(e))}catch(i){u(i)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(p,f);o((r=r.apply(h,c)).next())});import{a as N,B as v}from"./index-BIkrAlj7.js";import{u as L,_ as T}from"./useForm-BsovIqMX.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import{bw as x,bx as B,i as F,b as R}from"./entry/index-BbJQUQ84-1718268303552.js";import"./componentMap-qA-f8iV4.js";import{a as S,m as k,b as A,c as C}from"./index-CCBbV1HU.js";import{m as P}from"./menu.data-CGB81tOC.js";import{d as D,f as E,c as U,Z as V,a8 as $,a9 as G,k as H,u as n,ac as K}from"./vue-Cw15aJ-2.js";import"./antd-DMGzOvrA.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./helper-CXVLNTBN.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./index-DCvxWw7W.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./copyTextToClipboard-uEEWQikS.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./style-CLEvKZSv.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";import"./dict-vVDMuEaq.js";import"./dictEnum-DeC8h6ZR.js";const he=D({name:"MenuModal",__name:"MenuModal",emits:["reload","register"],setup(h,{emit:c}){const r=c,s=E(!1),u=U(()=>s.value?"修改菜单":"添加菜单"),[p,{validate:f,setFieldsValue:o,resetForm:e,updateSchema:i}]=L({schemas:P,showActionButtonGroup:!1,labelWidth:100,name:"menu_modal"}),[w,{modalLoading:d,closeModal:I}]=N(a=>l(this,null,function*(){d(!0);const{record:t,update:m}=a;if(s.value=m,t&&t.parentId&&(yield o({parentId:t.parentId})),m&&t){const y=yield S(t.menuId);yield o(y)}yield M(),d(!1)}));function M(){return l(this,null,function*(){const a=yield k(),m=[{menuName:"根目录",menuId:0,children:x(a,{id:"menuId",pid:"parentId"})}];B(m,"menuName"," / "),yield i({field:"parentId",componentProps:{treeData:m,fieldNames:{label:"menuName",value:"menuId"},treeDefaultExpandAll:!1,treeNodeLabelProp:"fullName",treeLine:{showLeafIcon:!1},treeDefaultExpandedKeys:[0],listHeight:300}})})}const{refreshMenu:_}=F(),g=R("refreshMenu",!0);function b(){return l(this,null,function*(){try{d(!0);const a=yield f();n(s)?yield A(a):yield C(a),yield e(),r("reload",()=>l(this,null,function*(){I(),g.value&&(yield _())}))}catch(a){}finally{d(!1)}})}return(a,t)=>(V(),$(n(v),K(a.$attrs,{title:u.value,width:700,onRegister:n(w),onOk:b,onCancel:n(e)}),{default:G(()=>[H(n(T),{onRegister:n(p)},null,8,["onRegister"])]),_:1},16,["title","onRegister","onCancel"]))}});export{he as default};
