var l=(e,n,t)=>new Promise((a,s)=>{var i=r=>{try{o(t.next(r))}catch(c){s(c)}},d=r=>{try{o(t.throw(r))}catch(c){s(c)}},o=r=>r.done?a(r.value):Promise.resolve(r.value).then(i,d);o((t=t.apply(e,n)).next())});import{O as u}from"./entry/index-CMepwc5X-1716790511191.js";import{u as w}from"./useLoading-iCq4GOHr.js";const[f,b]=w({tip:"加载中..."});function L(e,n,t=!0){return l(this,null,function*(){try{f();const a=yield e();m(a,n,t)}finally{b()}})}function m(e,n,t=!0){let a=n;t&&(a=`${n}-${new Date().getTime()}.xlsx`),p(e,a)}function p(e,n,t,a){const s=[e],i=new Blob(s,{type:t||"application/octet-stream"}),d=window.URL.createObjectURL(i),o=document.createElement("a");o.style.display="none",o.href=d,o.setAttribute("download",n),typeof o.download=="undefined"&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(d)}function x({url:e,target:n="_blank",fileName:t}){const a=window.navigator.userAgent.toLowerCase().indexOf("chrome")>-1,s=window.navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(/(iP)/g.test(window.navigator.userAgent))return console.error("Your browser does not support download!"),!1;if(a||s){const i=document.createElement("a");if(i.href=e,i.target=n,i.download!==void 0&&(i.download=t||e.substring(e.lastIndexOf("/")+1,e.length)),document.createEvent){const d=document.createEvent("MouseEvents");return d.initEvent("click",!0,!0),i.dispatchEvent(d),!0}}return e.indexOf("?")===-1&&(e+="?download"),u(e,{target:n}),!0}export{x as a,L as b,p as d};
