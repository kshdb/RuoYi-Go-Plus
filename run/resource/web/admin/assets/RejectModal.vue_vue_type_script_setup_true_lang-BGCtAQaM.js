var p=(b,m,o)=>new Promise((u,a)=>{var c=e=>{try{n(o.next(e))}catch(s){a(s)}},f=e=>{try{n(o.throw(e))}catch(s){a(s)}},n=e=>e.done?u(e.value):Promise.resolve(e.value).then(c,f);n((o=o.apply(b,m)).next())});import{a as x,B as M}from"./index-CMSTH4sS.js";import{u as T,_ as A}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{b as R,e as B}from"./index-D8V_F1G-.js";import{h as S}from"./entry/index-CMepwc5X-1716790511191.js";import{d as V,aa as F,_ as G,a8 as L,a9 as l,k as d,G as I,u as r,ad as N}from"./vue-Bw3NQgLF.js";import{P as j}from"./antd-BRjMhd0C.js";const w=[{value:"1",label:"站内信",disabled:!0},{value:"2",label:"邮箱"},{value:"3",label:"短信"}],U=[{label:"taskId",component:"Input",field:"taskId",show:!1},{label:"消息提醒",field:"messageType",component:"CheckboxGroup",defaultValue:["1"],componentProps:{options:w}},{label:"审批意见",component:"InputTextArea",field:"message",componentProps:{placeholder:"输入审批意见",rows:3}},{label:"抄送",field:"wfCopyList",slot:"wfCopyList"},{label:"附件",field:"fileId",slot:"fileId"}],O=[{label:"taskId",component:"Input",field:"taskId",show:!1},{label:"消息提醒",field:"messageType",component:"CheckboxGroup",defaultValue:["1"],componentProps:{options:w}},{label:"驳回节点",component:"Select",field:"targetActivityId",required:!0},{label:"审批意见",component:"InputTextArea",field:"message",componentProps:{placeholder:"输入审批意见",rows:3}}],X=V({__name:"RejectModal",emits:["register","reload"],setup(b,{emit:m}){const o=m,[u,{modalLoading:a,closeModal:c}]=x(f);function f(t){return p(this,null,function*(){a(!0);const{taskId:h,processInstanceId:i}=t,v=(yield R(i)).map(_=>({label:_.nodeName,value:_.nodeId}));yield y({field:"targetActivityId",componentProps:{options:v}}),yield k({taskId:h}),a(!1)})}const[n,{validate:e,resetForm:s,setFieldsValue:k,updateSchema:y}]=T({labelWidth:100,name:"reject_modal",showActionButtonGroup:!1,schemas:O,baseColProps:{span:24}});function g(){return p(this,null,function*(){c(),yield s()})}const{createMessage:C}=S();function P(){return p(this,null,function*(){try{a(!0);const t=yield e();yield B(t),C.success("操作成功"),o("reload"),c(),s()}catch(t){console.warn(t)}finally{a(!1)}})}return(t,h)=>{const i=F("a-button");return G(),L(r(M),N(t.$attrs,{title:"驳回",width:600,"can-fullscreen":!1,onRegister:r(u),onCancel:g}),{footer:l(()=>[d(i,{onClick:g},{default:l(()=>[I("取消")]),_:1}),d(r(j),{placement:"topRight",title:"确认驳回吗?","ok-text":"确认","cancel-text":"再想想",onConfirm:P},{default:l(()=>[d(i,{type:"primary",danger:""},{default:l(()=>[I("驳回")]),_:1})]),_:1})]),default:l(()=>[d(r(A),{onRegister:r(n)},null,8,["onRegister"])]),_:1},16,["onRegister"])}}});export{X as _,U as m};
