var p=(d,k,c)=>new Promise((u,a)=>{var g=s=>{try{m(c.next(s))}catch(i){a(i)}},x=s=>{try{m(c.throw(s))}catch(i){a(i)}},m=s=>s.done?u(s.value):Promise.resolve(s.value).then(g,x);m((c=c.apply(d,k)).next())});import{a as V,B as P}from"./index-BIkrAlj7.js";import{_ as E}from"./index-BcLdq1Bd.js";import{d as K,u as O}from"./index-Bys7JeoU.js";import{u as $,_ as j}from"./useTable-CNbfTOCZ.js";import"./index-DCvxWw7W.js";import{D as z}from"./dictEnum-DeC8h6ZR.js";import{u as q}from"./useRender-D1Q3fAQ3.js";import{bj as G,l as J}from"./entry/index-BbJQUQ84-1718268303552.js";import{j as W}from"./index-DH8S7RKQ.js";import{as as R,y as Z,A as H,U as D,ar as Q}from"./antd-DMGzOvrA.js";import{d as X,f as w,r as Y,o as ee,Z as n,a8 as f,a9 as l,k as I,u as e,ac as S,ab as C,ak as te,al as ae,_ as M,aa as se,G as re,a0 as oe,F as T}from"./vue-Cw15aJ-2.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./index-Dx0uas1b.js";import"./dict-vVDMuEaq.js";const{renderDict:le}=q(),ne=[{dataIndex:"userName",title:"名称"},{dataIndex:"nickName",title:"昵称"},{dataIndex:"avatar",title:"头像",width:80},{dataIndex:"deptName",title:"部门"},{dataIndex:"phonenumber",title:"手机号"},{dataIndex:"status",title:"状态",customRender({value:d}){return le(d,z.NORMAL_DISABLE)}},{dataIndex:"createTime",title:"创建时间"}],ce=[{field:"userName",label:"用户账号",component:"Input"},{field:"phonenumber",label:"手机号码",component:"Input"}],ie=X({name:"AddMultiInstanceModal",__name:"index",props:{multiple:{type:Boolean,required:!1,default:!0}},emits:["register","selectDone"],setup(d,{emit:k}){const c=d,u=w(""),a=Y({tree:[],selectDeptId:[]}),g=w(!0);function x(){return p(this,null,function*(){yield s()})}ee(()=>p(this,null,function*(){const t=yield K();G(t,o=>{o.icon="el:group"}),a.tree=t,g.value=!1}));const[m,{reload:s,getSelectRows:i,setSelectedRows:y}]=$({rowSelection:{type:"checkbox"},showSelectionBar:!0,clickToRowSelect:!0,clearSelectOnPageChange:!1,showIndexColumn:!1,size:"small",api:O,rowKey:"userId",useSearchForm:!0,formConfig:{schemas:ce,name:"user",baseColProps:{xs:24,sm:24,md:24,lg:8},labelWidth:80,resetFunc:()=>p(this,null,function*(){a.selectDeptId=[],u.value="",yield s()})},columns:ne,beforeFetch(t){return a.selectDeptId.length===1&&(t.deptId=a.selectDeptId[0]),h.value&&(t.excludeUserIds=h.value),t}}),h=w(""),[N,{closeModal:B,modalLoading:_}]=V(A);function A(t){return p(this,null,function*(){_(!0);const o=yield W(t);h.value=o,_(!1)})}const F=k;function L(){F("selectDone",i()),B(),v()}function v(){h.value="",y([])}function U(t){c.multiple||y([t])}return(t,o)=>(n(),f(e(P),S(t.$attrs,{title:"用户选择",defaultFullscreen:"",canFullscreen:!1,onRegister:e(N),onOk:L,onCancel:v}),{default:l(()=>[I(e(Q),null,{default:l(()=>[I(e(R),S({xs:24,sm:24,md:24,lg:4},{class:"h-[calc(100vh-80px)]"}),{default:l(()=>[I(e(Z),{active:!0,paragraph:{rows:8},loading:g.value},{default:l(()=>[a.tree.length?(n(),f(e(E),{key:0,fieldNames:{title:"label",key:"id"},"tree-data":a.tree,showLine:{showLeafIcon:!1},search:!0,searchValue:u.value,"onUpdate:searchValue":o[0]||(o[0]=r=>u.value=r),defaultExpandAll:"",onSelect:x,selectedKeys:a.selectDeptId,"onUpdate:selectedKeys":o[1]||(o[1]=r=>a.selectDeptId=r)},null,8,["tree-data","searchValue","selectedKeys"])):C("",!0)]),_:1},8,["loading"])]),_:1},16),I(e(R),te(ae({xs:24,sm:24,md:24,lg:20})),{default:l(()=>[I(e(j),{onRegister:e(m),onRowClick:U},{tableTitle:l(()=>[(n(!0),M(T,null,se(e(i)(),r=>(n(),f(e(H),{key:r.userId},{default:l(()=>[re(oe(r.nickName),1)]),_:2},1024))),128))]),bodyCell:l(({column:r,record:b})=>[r&&b&&r.dataIndex==="avatar"?(n(),M(T,{key:0},[b.avatar?(n(),f(e(D),{key:0,src:b.avatar},null,8,["src"])):(n(),f(e(D),{key:1,src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}))],64)):C("",!0)]),_:1},8,["onRegister"])]),_:1},16)]),_:1})]),_:1},16,["onRegister"]))}}),Pe=J(ie,[["__scopeId","data-v-657b1ca0"]]);export{Pe as default};
