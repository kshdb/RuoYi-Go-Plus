var p=(l,a,s)=>new Promise((c,t)=>{var r=e=>{try{o(s.next(e))}catch(n){t(n)}},u=e=>{try{o(s.throw(e))}catch(n){t(n)}},o=e=>e.done?c(e.value):Promise.resolve(e.value).then(r,u);o((s=s.apply(l,a)).next())});import{d as g,ao as _,o as y,_ as C,$ as L}from"./vue-Bw3NQgLF.js";import{b as h,c as k,a as B,e as E,f as I,P as M,h as S}from"./entry/index-CMepwc5X-1716790511191.js";import{u as T}from"./useLoading-iCq4GOHr.js";import{a as q}from"./common-DAyXvPhm.js";import"./antd-BRjMhd0C.js";const x="000000",A=g({__name:"index",setup(l){const a=_(),s=a.query.code,c=a.query.state,t=a.query.source,r=h("tenantId",x),u=k(),{createMessage:o}=S(),[e,n]=T({tip:"加载中..."}),{login:f}=B();return y(()=>p(this,null,function*(){try{if(e(),!q.find(m=>m.source===t&&m.action)){o.error({content:`未找到${t}平台`});return}const i={socialCode:s,socialState:c,tenantId:r.value,source:t,grantType:"social"};E()?(yield I(i),o.success(t+"授权成功")):(yield f(i),o.success(t+"登录成功"))}catch(d){}finally{n(),setTimeout(()=>{u(M.BASE_HOME)},2e3)}})),(d,i)=>(C(),L("div"))}});export{A as default};
