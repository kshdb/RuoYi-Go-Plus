var h=(E,b,p)=>new Promise((l,c)=>{var w=m=>{try{i(p.next(m))}catch(f){c(f)}},I=m=>{try{i(p.throw(m))}catch(f){c(f)}},i=m=>m.done?l(m.value):Promise.resolve(m.value).then(w,I);i((p=p.apply(E,b)).next())});import{P as q}from"./index-C4nZBquz.js";import{_ as H}from"./index-BcLdq1Bd.js";import{d as J,u as O,h as Q,i as P,j as X}from"./index-Bys7JeoU.js";import{u as ee,_ as te}from"./useTable-CNbfTOCZ.js";import{_ as ae}from"./index-DCvxWw7W.js";import{T as se}from"./TableSwitch-Dq-a_0E1.js";import{i as oe,bj as re,aR as ne,I as D,l as ie}from"./entry/index-BbJQUQ84-1718268303552.js";import{_ as le}from"./UserResetPwdModal.vue_vue_type_script_setup_true_lang-207K82Ja.js";import{_ as me}from"./UserImportModal.vue_vue_type_script_setup_true_lang-C1yATGQW.js";import{u as R}from"./index-BIkrAlj7.js";import{b as de}from"./download-DOz9ltI1.js";import{s as ue,c as pe}from"./user.data--syaYDXk.js";import ce from"./UserDrawer-dzXYZDLm.js";import{u as fe}from"./index-BLDmWVyR.js";import{_ as he}from"./UserInfoModal.vue_vue_type_script_setup_true_lang-vWvFEeab.js";import{ar as _e,as as T,y as ge,ax as S,aa as ye,U as $}from"./antd-DMGzOvrA.js";import{d as be,f as V,r as we,o as Ie,a7 as ve,n as ke,Z as o,a8 as u,a9 as r,k as n,u as e,ac as De,_ as x,ak as Re,al as xe,m as g,G as y,F as Ce,ab as C}from"./vue-Cw15aJ-2.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./index-BVlzXcPd.js";import"./useDescription-DLkhA-M6.js";import"./useLoading-D1in2ACg.js";import"./rules-Boel_RXz.js";import"./dict-vVDMuEaq.js";import"./dictEnum-DeC8h6ZR.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";import"./index-DGT8hE2-.js";import"./useSize-CUNtmCvH.js";import"./role.data-wz2Oc4N6.js";import"./user.info-Cn6Hq0cQ.js";const Ee={key:1,class:"mt-5"},Me=be({name:"User",__name:"index",setup(E){const{hasPermission:b}=oe(),p=V(""),l=we({tree:[],selectDeptId:[]}),c=V(!0);function w(){return h(this,null,function*(){yield i()})}Ie(()=>h(this,null,function*(){const a=yield J();re(a,s=>{s.icon="el:group"}),l.tree=a,c.value=!1}));const[I,{reload:i,selected:m,multipleRemove:f}]=ee({rowSelection:{type:"checkbox",getCheckboxProps:a=>({disabled:a.userId===1})},title:"用户列表",showIndexColumn:!1,api:O,rowKey:"userId",useSearchForm:!0,formConfig:{schemas:ue,name:"user",baseColProps:{xs:24,sm:24,md:24,lg:8},labelWidth:100,resetFunc:()=>h(this,null,function*(){l.selectDeptId=[],p.value="",yield i()}),fieldMapToTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},columns:pe,beforeFetch(a){return l.selectDeptId.length===1&&(a.deptId=l.selectDeptId[0]),a},actionColumn:{width:220,title:"操作",key:"action",fixed:"right"}}),[N,{openDrawer:M}]=fe(),[U,{openModal:Y}]=R(),[A,{openModal:B}]=R(),[F,{openModal:L}]=R();function K(){B(!0)}function W(a){Y(!0,a)}function j(a){const{userId:s}=a;L(!0,s)}function G(a){M(!0,{update:!0,record:a})}function z(){M(!0,{update:!1})}function Z(a){return h(this,null,function*(){yield P([a.userId]),yield i()})}return(a,s)=>{const v=ve("a-button"),_=ke("auth");return o(),u(e(q),{dense:""},{default:r(()=>[n(e(_e),null,{default:r(()=>[n(e(T),De({xs:24,sm:24,md:24,lg:4},{class:"h-[calc(100vh-80px)]"}),{default:r(()=>[n(e(ge),{active:!0,paragraph:{rows:8},loading:c.value},{default:r(()=>[l.tree.length?(o(),u(e(H),{key:0,fieldNames:{title:"label",key:"id"},"tree-data":l.tree,showLine:{showLeafIcon:!1},search:!0,searchValue:p.value,"onUpdate:searchValue":s[0]||(s[0]=d=>p.value=d),defaultExpandAll:"",onSelect:w,selectedKeys:l.selectDeptId,"onUpdate:selectedKeys":s[1]||(s[1]=d=>l.selectDeptId=d)},null,8,["tree-data","searchValue","selectedKeys"])):(o(),x("div",Ee,[n(e(S),{image:e(S).PRESENTED_IMAGE_SIMPLE,description:"无部门数据"},null,8,["image"])]))]),_:1},8,["loading"])]),_:1},16),n(e(T),Re(xe({xs:24,sm:24,md:24,lg:20})),{default:r(()=>[n(e(te),{onRegister:e(I)},{toolbar:r(()=>[n(e(ye),{class:"<sm:hidden"},{default:r(()=>[g((o(),u(v,{onClick:K},{default:r(()=>[y("导入")]),_:1})),[[_,"system:user:import"]]),g((o(),x("div",null,[n(e(ne),{placement:"left",title:"确认导出表格吗?",onConfirm:s[2]||(s[2]=d=>e(de)(e(Q),"用户数据"))},{default:r(()=>[y("导出")]),_:1})])),[[_,"system:user:export"]]),g((o(),u(v,{class:"<sm:hidden",type:"primary",danger:"",onClick:s[3]||(s[3]=d=>e(f)(e(P))),disabled:!e(m)},{default:r(()=>[y("删除")]),_:1},8,["disabled"])),[[_,"system:user:remove"]]),g((o(),u(v,{type:"primary",onClick:z},{default:r(()=>[y("新增")]),_:1})),[[_,"system:user:add"]])]),_:1})]),bodyCell:r(({column:d,record:t})=>[d.dataIndex==="avatar"?(o(),x(Ce,{key:0},[t.avatar?(o(),u(e($),{key:0,src:t.avatar},null,8,["src"])):(o(),u(e($),{key:1,src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}))],64)):C("",!0),d.dataIndex==="status"?(o(),u(e(se),{key:1,modelValue:t.status,"onUpdate:modelValue":k=>t.status=k,disabled:t.userId===1||!e(b)("system:user:edit"),api:()=>e(X)(t),"custom-content":k=>`确认${k}用户[${t.userName}]吗?`,reload:e(i)},null,8,["modelValue","onUpdate:modelValue","disabled","api","custom-content","reload"])):C("",!0),d.key==="action"?(o(),u(e(ae),{key:2,stopButtonPropagation:"",dropDownBtnDisplay:"",actions:[{label:"修改",icon:e(D).EDIT,type:"primary",ghost:!0,auth:"system:user:edit",ifShow:t.userId!==1,onClick:G.bind(null,t)},{label:"删除",icon:e(D).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:user:remove",ifShow:t.userId!==1,popConfirm:{placement:"left",title:`是否删除用户[${t.userName}]-${t.nickName}?`,confirm:Z.bind(null,t)}}],dropDownActions:[{label:"用户信息",icon:"ph:user-light",auth:"system:user:list",ifShow:t.userId!==1,onClick:j.bind(null,t)},{label:"重置密码",icon:e(D).RESET_PWD,auth:"system:user:resetPwd",ifShow:t.userId!==1,onClick:W.bind(null,t)}]},null,8,["actions","dropDownActions"])):C("",!0)]),_:1},8,["onRegister"])]),_:1},16)]),_:1}),n(ce,{onRegister:e(N),onReload:e(i)},null,8,["onRegister","onReload"]),n(le,{onRegister:e(U),onReload:e(i)},null,8,["onRegister","onReload"]),n(me,{onRegister:e(A),onReload:e(i)},null,8,["onRegister","onReload"]),n(he,{onRegister:e(F)},null,8,["onRegister"])]),_:1})}}}),bt=ie(Me,[["__scopeId","data-v-bf510b3e"]]);export{bt as default};
