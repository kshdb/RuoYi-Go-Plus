var A=(C,u,s)=>new Promise((c,f)=>{var h=o=>{try{i(s.next(o))}catch(l){f(l)}},b=o=>{try{i(s.throw(o))}catch(l){f(l)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(h,b);i((s=s.apply(C,u)).next())});import{P as S}from"./index-C4nZBquz.js";import{u as $,_ as N}from"./useTable-CNbfTOCZ.js";import{_ as P}from"./index-DCvxWw7W.js";import{d as B,f as F,c as L,_ as M,a as V}from"./DeptModal.vue_vue_type_script_setup_true_lang-DO1rJkMx.js";import{u as q}from"./index-BIkrAlj7.js";import{b as G,bw as K,bA as O,I as y}from"./entry/index-BbJQUQ84-1718268303552.js";import{d as W,a7 as Z,n as j,Z as _,a8 as g,a9 as r,k as m,u as a,ad as z,G as x,m as H,ab as J,y as Q}from"./vue-Cw15aJ-2.js";import{aq as U}from"./antd-DMGzOvrA.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./index-Bys7JeoU.js";import"./dictEnum-DeC8h6ZR.js";import"./dict-vVDMuEaq.js";import"./rules-Boel_RXz.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";const Re=W({name:"Dept",__name:"index",setup(C){const u=G("__dept_tip_read",!1),[s,{getRawDataSource:c,expandRows:f,collapseRows:h,expandAll:b,collapseAll:i,reload:o}]=$({title:"部门列表",isTreeTable:!0,showTableSetting:!0,api:B,pagination:!1,rowKey:"deptId",afterFetch(t){const e=K(t,{id:"deptId",pid:"parentId"});return O(e),e},useSearchForm:!0,formConfig:{schemas:F,name:"dept",baseColProps:{xs:24,sm:24,md:24,lg:6}},columns:L,actionColumn:{title:"操作",key:"action",fixed:"right"}});function l(){const t=c();t instanceof Array&&(t.forEach(e=>{e.expand=!0}),Q(b))}const[T,{openModal:k}]=q();function D(t){const{deptId:e}=t;k(!0,{deptId:e,update:!0})}function v(t){k(!0,{deptId:t,update:!1})}function R(t){return A(this,null,function*(){yield V(t),yield o()})}function w(t){const e=c();if(e instanceof Array)switch(t){case"expandAll":e.forEach(n=>{n.expand=!0}),b();break;case"collapseAll":e.forEach(n=>{n.expand=!1}),i();break}}function E(t){const{deptId:e}=t;t.expand===!0?(h([e]),t.expand=!1):(f([e]),t.expand=!0)}return(t,e)=>{const n=Z("a-button"),I=j("auth");return _(),g(a(S),{dense:""},{default:r(()=>[m(a(N),{onRegister:a(s),onFetchSuccess:l,onRowDbClick:E},z({toolbar:r(()=>[m(n,{class:"<sm:hidden",onClick:e[1]||(e[1]=p=>w("expandAll"))},{default:r(()=>[x("展开")]),_:1}),m(n,{class:"<sm:hidden",onClick:e[2]||(e[2]=p=>w("collapseAll"))},{default:r(()=>[x("折叠")]),_:1}),H((_(),g(n,{type:"primary",onClick:e[3]||(e[3]=p=>v(100))},{default:r(()=>[x(" 新增 ")]),_:1})),[[I,"system:dept:add"]])]),bodyCell:r(({column:p,record:d})=>[p.key==="action"?(_(),g(a(P),{key:0,stopButtonPropagation:"",actions:[{label:"修改",icon:a(y).EDIT,type:"primary",ghost:!0,auth:"system:dept:edit",onClick:D.bind(null,d)},{label:"新增",icon:a(y).ADD,type:"primary",color:"success",ghost:!0,auth:"system:dept:add",onClick:v.bind(null,d.deptId)},{label:"删除",icon:a(y).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:dept:remove",ifShow:()=>d.parentId!==0,popConfirm:{title:`是否删除部门[${d.deptName}]`,placement:"left",confirm:R.bind(null,d.deptId)}}]},null,8,["actions"])):J("",!0)]),_:2},[a(u)?void 0:{name:"headerTop",fn:r(()=>[m(a(U),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=p=>u.value=!0)})]),key:"0"}]),1032,["onRegister"]),m(M,{onRegister:a(T),onReload:a(o)},null,8,["onRegister","onReload"])]),_:1})}}});export{Re as default};
