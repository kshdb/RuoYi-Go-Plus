var _=(E,p,o)=>new Promise((y,w)=>{var I=m=>{try{c(o.next(m))}catch(f){w(f)}},i=m=>{try{c(o.throw(m))}catch(f){w(f)}},c=m=>m.done?y(m.value):Promise.resolve(m.value).then(I,i);c((o=o.apply(E,p)).next())});import{P as q}from"./index-DrfqwNLV.js";import{_ as H}from"./index-CwwL6bPg.js";import{d as J,u as O,h as Q,i as T,j as X}from"./index-Cm0AtxlD.js";import{u as Z,_ as ee}from"./useTable-BlleqRm-.js";import{_ as te}from"./index-Rv_3g2e8.js";import{T as ae}from"./TableSwitch-CXPFPejB.js";import{bj as oe,aU as se,I as k,j as re}from"./entry/index-CMepwc5X-1716790511191.js";import{_ as ne}from"./UserResetPwdModal.vue_vue_type_script_setup_true_lang-QLYViAL8.js";import{_ as le}from"./UserImportModal.vue_vue_type_script_setup_true_lang-C95NSS5J.js";import{u as R}from"./index-CMSTH4sS.js";import{b as ie}from"./download-CYeVxFqw.js";import{s as me,c as de}from"./user.data-BkoKoiKl.js";import ue from"./UserDrawer-Ci7nw87G.js";import{u as pe}from"./index-ov0mgIjt.js";import{_ as ce}from"./UserInfoModal.vue_vue_type_script_setup_true_lang-BZfrjxtU.js";import{at as fe,au as S,y as he,ay as P,ad as _e,U as $}from"./antd-BRjMhd0C.js";import{d as ge,f as V,r as ye,o as we,aa as be,n as Ie,_ as r,a8 as u,a9 as n,k as l,u as e,ad as ve,$ as x,al as De,am as ke,m as g,G as b,F as Re,ac as C}from"./vue-Bw3NQgLF.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./index-ByLT-Lkv.js";import"./useDescription-Cm6mcuk5.js";import"./useLoading-iCq4GOHr.js";import"./rules-Boel_RXz.js";import"./dict-C9gNHjAh.js";import"./dictEnum-DeC8h6ZR.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./index-tTbWyNHk.js";import"./useSize-tRF5RUOv.js";import"./role.data-DFU5aoTG.js";import"./user.info-LALXltIy.js";const xe={key:1,class:"mt-5"},Ce=ge({name:"User",__name:"index",setup(E){const p=V(""),o=ye({tree:[],selectDeptId:[]}),y=V(!0);function w(){return _(this,null,function*(){yield i()})}we(()=>_(this,null,function*(){const a=yield J();oe(a,s=>{s.icon="el:group"}),o.tree=a,y.value=!1}));const[I,{reload:i,selected:c,multipleRemove:m}]=Z({rowSelection:{type:"checkbox",getCheckboxProps:a=>({disabled:a.userId===1})},title:"用户列表",showIndexColumn:!1,api:O,rowKey:"userId",useSearchForm:!0,formConfig:{schemas:me,name:"user",baseColProps:{xs:24,sm:24,md:24,lg:8},labelWidth:100,resetFunc:()=>_(this,null,function*(){o.selectDeptId=[],p.value="",yield i()}),fieldMapToTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},columns:de,beforeFetch(a){return o.selectDeptId.length===1&&(a.deptId=o.selectDeptId[0]),a},actionColumn:{width:220,title:"操作",key:"action",fixed:"right"}}),[f,{openDrawer:M}]=pe(),[U,{openModal:N}]=R(),[Y,{openModal:A}]=R(),[B,{openModal:F}]=R();function L(){A(!0)}function K(a){N(!0,a)}function j(a){const{userId:s}=a;F(!0,s)}function W(a){M(!0,{update:!0,record:a})}function G(){M(!0,{update:!1})}function z(a){return _(this,null,function*(){yield T([a.userId]),yield i()})}return(a,s)=>{const v=be("a-button"),h=Ie("auth");return r(),u(e(q),{dense:""},{default:n(()=>[l(e(fe),null,{default:n(()=>[l(e(S),ve({xs:24,sm:24,md:24,lg:4},{class:"h-[calc(100vh-80px)]"}),{default:n(()=>[l(e(he),{active:!0,paragraph:{rows:8},loading:y.value},{default:n(()=>[o.tree.length?(r(),u(e(H),{key:0,fieldNames:{title:"label",key:"id"},"tree-data":o.tree,showLine:{showLeafIcon:!1},search:!0,searchValue:p.value,"onUpdate:searchValue":s[0]||(s[0]=d=>p.value=d),defaultExpandAll:"",onSelect:w,selectedKeys:o.selectDeptId,"onUpdate:selectedKeys":s[1]||(s[1]=d=>o.selectDeptId=d)},null,8,["tree-data","searchValue","selectedKeys"])):(r(),x("div",xe,[l(e(P),{image:e(P).PRESENTED_IMAGE_SIMPLE,description:"无部门数据"},null,8,["image"])]))]),_:1},8,["loading"])]),_:1},16),l(e(S),De(ke({xs:24,sm:24,md:24,lg:20})),{default:n(()=>[l(e(ee),{onRegister:e(I)},{toolbar:n(()=>[l(e(_e),{class:"<sm:hidden"},{default:n(()=>[g((r(),u(v,{onClick:L},{default:n(()=>[b("导入")]),_:1})),[[h,"system:user:import"]]),g((r(),x("div",null,[l(e(se),{placement:"left",title:"确认导出表格吗?",onConfirm:s[2]||(s[2]=d=>e(ie)(e(Q),"用户数据"))},{default:n(()=>[b("导出")]),_:1})])),[[h,"system:user:export"]]),g((r(),u(v,{class:"<sm:hidden",type:"primary",danger:"",onClick:s[3]||(s[3]=d=>e(m)(e(T))),disabled:!e(c)},{default:n(()=>[b("删除")]),_:1},8,["disabled"])),[[h,"system:user:remove"]]),g((r(),u(v,{type:"primary",onClick:G},{default:n(()=>[b("新增")]),_:1})),[[h,"system:user:add"]])]),_:1})]),bodyCell:n(({column:d,record:t})=>[d.dataIndex==="avatar"?(r(),x(Re,{key:0},[t.avatar?(r(),u(e($),{key:0,src:t.avatar},null,8,["src"])):(r(),u(e($),{key:1,src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}))],64)):C("",!0),d.dataIndex==="status"?g((r(),u(e(ae),{key:1,modelValue:t.status,"onUpdate:modelValue":D=>t.status=D,disabled:t.userId===1,api:()=>e(X)(t),"custom-content":D=>`确认${D}用户[${t.userName}]吗?`,reload:e(i)},null,8,["modelValue","onUpdate:modelValue","disabled","api","custom-content","reload"])),[[h,"system:user:edit"]]):C("",!0),d.key==="action"?(r(),u(e(te),{key:2,stopButtonPropagation:"",dropDownBtnDisplay:"",actions:[{label:"修改",icon:e(k).EDIT,type:"primary",ghost:!0,auth:"system:user:edit",ifShow:t.userId!==1,onClick:W.bind(null,t)},{label:"删除",icon:e(k).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:user:remove",ifShow:t.userId!==1,popConfirm:{placement:"left",title:`是否删除用户[${t.userName}]-${t.nickName}?`,confirm:z.bind(null,t)}}],dropDownActions:[{label:"用户信息",icon:"ph:user-light",auth:"system:user:list",ifShow:t.userId!==1,onClick:j.bind(null,t)},{label:"重置密码",icon:e(k).RESET_PWD,auth:"system:user:resetPwd",ifShow:t.userId!==1,onClick:K.bind(null,t)}]},null,8,["actions","dropDownActions"])):C("",!0)]),_:1},8,["onRegister"])]),_:1},16)]),_:1}),l(ue,{onRegister:e(f),onReload:e(i)},null,8,["onRegister","onReload"]),l(ne,{onRegister:e(U),onReload:e(i)},null,8,["onRegister","onReload"]),l(le,{onRegister:e(Y),onReload:e(i)},null,8,["onRegister","onReload"]),l(ce,{onRegister:e(B)},null,8,["onRegister"])]),_:1})}}}),_t=re(Ce,[["__scopeId","data-v-89e769f0"]]);export{_t as default};
