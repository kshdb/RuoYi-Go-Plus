var d=(t,f,a)=>new Promise((r,c)=>{var p=o=>{try{i(a.next(o))}catch(l){c(l)}},n=o=>{try{i(a.throw(o))}catch(l){c(l)}},i=o=>o.done?r(o.value):Promise.resolve(o.value).then(p,n);i((a=a.apply(t,f)).next())});import{a as I,B as R}from"./index-CMSTH4sS.js";import{u as x,_ as T}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{a as N,b as k,c as B}from"./index-BIzCyvWB.js";import{u as C}from"./useRender-C6p2srTi.js";import{D as h}from"./dictEnum-DeC8h6ZR.js";import{g as E}from"./dict-C9gNHjAh.js";import{d as P,f as q,c as S,Z as v,_ as D,a8 as O,a9 as V,k as W,u as s,ad as A}from"./vue-Bw3NQgLF.js";import{h as G}from"./entry/index-CMepwc5X-1716790511191.js";const te=[{label:"表单名称",field:"formName",component:"Input"}],{renderDict:U}=C(),ae=[{title:"表单名称",dataIndex:"formName"},{title:"表单类型",dataIndex:"formType",customRender({value:t}){return U(t,h.WF_FORM_TYPE)}},{title:"地址",dataIndex:"router"},{title:"备注",dataIndex:"remark"}],Y=[{label:"主键",field:"id",component:"Input",show:!1},{label:"表单名称",field:"formName",required:!0,component:"Input"},{label:"表单类型",field:"formType",required:!0,defaultValue:"static",component:"RadioButtonGroup",componentProps({formActionType:t}){return{options:E(h.WF_FORM_TYPE),onChange(a){return d(this,null,function*(){if(typeof a!="string")return;const r=a;t.updateSchema([{field:"router",required:r==="static"},{field:"formTypeName",required:r==="dynamic"}]),yield t.clearValidate(["router","formTypeName"])})}}}},{label:"路由地址",field:"router",required:!0,component:"Input",show({model:t}){return t.formType==="static"}},{label:"表单",field:"formTypeName",component:"Select",componentProps:{disabled:!0,placeholder:"暂不支持"},show({model:t}){return t.formType==="dynamic"}},{label:"备注",field:"remark",component:"InputTextArea"}],oe=P({name:"FormManageModal",__name:"FormManageModal",emits:["register","reload"],setup(t,{emit:f}){const a=f,r=q(!1),c=S(()=>r.value?"编辑表单配置":"新增表单配置"),[p,{modalLoading:n,closeModal:i}]=I(e=>d(this,null,function*(){n(!0);const{record:m,update:u}=e;if(r.value=u,u&&m){const b=yield N(m.id);yield l(b)}n(!1)})),[o,{setFieldsValue:l,resetForm:g,validate:_}]=x({labelWidth:100,showActionButtonGroup:!1,baseColProps:{span:24},schemas:Y}),w=v();function y(e){return w.getRoutes().find(u=>u.path===e)}const{createMessage:M}=G();function F(){return d(this,null,function*(){try{n(!0);const e=yield _();if(e.formType==="static"&&!y(e.router)){M.error({content:"路由地址不存在, 添加后重试!"});return}s(r)?yield k(e):yield B(e),a("reload"),i(),yield g()}catch(e){console.warn(e)}finally{n(!1)}})}return(e,m)=>(D(),O(s(R),A(e.$attrs,{title:c.value,onRegister:s(p),onOk:F,onCancel:s(g)}),{default:V(()=>[W(s(T),{onRegister:s(o)},null,8,["onRegister"])]),_:1},16,["title","onRegister","onCancel"]))}});export{oe as _,ae as c,te as f};
