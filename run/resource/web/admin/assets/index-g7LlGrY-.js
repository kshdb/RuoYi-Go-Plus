var k=Object.defineProperty,v=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var g=(e,a,t)=>a in e?k(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,y=(e,a)=>{for(var t in a||(a={}))F.call(a,t)&&g(e,t,a[t]);if(x)for(var t of x(a))E.call(a,t)&&g(e,t,a[t]);return e},C=(e,a)=>v(e,D(a));var p=(e,a,t)=>new Promise((d,c)=>{var u=r=>{try{l(t.next(r))}catch(m){c(m)}},_=r=>{try{l(t.throw(r))}catch(m){c(m)}},l=r=>r.done?d(r.value):Promise.resolve(r.value).then(u,_);l((t=t.apply(e,a)).next())});import{P as R}from"./index-C4nZBquz.js";import{D as S}from"./index-BVlzXcPd.js";import{aA as z,C as f,_ as b,I as w}from"./entry/index-BbJQUQ84-1718268303552.js";import B from"./MemoryChart-Cbufs9lO.js";import I from"./CommandChart-DvXqQIS9.js";import{u as P}from"./useLoading-D1in2ACg.js";import{u as $}from"./useDescription-DLkhA-M6.js";import{d as L,r as M,o as N,a7 as V,Z as A,a8 as H,a9 as s,k as o,u as n,$ as i,G}from"./vue-Cw15aJ-2.js";import{ar as K,as as h}from"./antd-DMGzOvrA.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useECharts-TE-BkXVl.js";function O(){return z.get({url:"/monitor/cache"})}const T=[{field:"redis_version",label:"redis版本"},{field:"redis_mode",label:"redis模式",render(e){return e==="standalone"?"单机模式":"集群模式"}},{field:"tcp_port",label:"tcp端口"},{field:"connected_clients",label:"客户端数"},{field:"uptime_in_days",label:"运行时间",render(e){return e+"天"}},{field:"used_memory_human",label:"使用内存"},{field:"used_cpu_user_children",label:"使用CPU",render(e){return parseFloat(e).toFixed(2)}},{field:"maxmemory_human",label:"内存配置"},{field:"aof_enabled",label:"AOF是否开启",render(e){return e==="0"?"否":"是"}},{field:"rdb_last_bgsave_status",label:"RDB是否成功"},{field:"dbSize",label:"Key数量"},{field:"instantaneous_input_kbps",label:"网络入口/出口",render(e,a){const{instantaneous_input_kbps:t,instantaneous_output_kbps:d}=a;return`${t}kps/${d}kps`}}],U={class:"flex gap-1.5"},W=i("span",null,"redis信息",-1),Z={class:"flex gap-1.5"},j=i("span",null,"命令统计",-1),q={class:"flex gap-1.5"},J=i("span",null,"内存占用",-1),me=L({name:"Cache",__name:"index",setup(e){const a=M({memory:"0",command:[]});N(()=>p(this,null,function*(){yield c()}));const[t,d]=P({tip:"加载中..."});function c(){return p(this,null,function*(){try{t();const l=yield O(),r=(parseInt(l.info.used_memory)/1024/1024).toFixed(2);a.memory=r,a.command=l.commandStats,_({data:C(y({},l.info),{dbSize:l.dbSize})})}catch(l){}finally{d()}})}const[u,{setDescProps:_}]=$({column:{xs:1,sm:1,md:3,lg:4,xl:4},schema:T});return(l,r)=>{const m=V("a-button");return A(),H(n(R),{title:"缓存监控"},{default:s(()=>[o(n(K),{gutter:[15,15]},{default:s(()=>[o(n(h),{span:24},{default:s(()=>[o(n(f),{canExpan:!1},{title:s(()=>[i("div",U,[o(b,{icon:"logos:redis",size:14}),W])]),action:s(()=>[o(m,{size:"small",class:"mr-2","pre-icon":n(w).REFRESH,onClick:c},{default:s(()=>[G("刷新")]),_:1},8,["pre-icon"])]),default:s(()=>[o(n(S),{onRegister:n(u)},null,8,["onRegister"])]),_:1})]),_:1}),o(n(h),{sm:24,xs:24,md:24,lg:12},{default:s(()=>[o(n(f),{title:"命令统计",canExpan:!1},{title:s(()=>[i("div",Z,[o(b,{icon:"flat-color-icons:command-line"}),j])]),default:s(()=>[o(I,{data:a.command},null,8,["data"])]),_:1})]),_:1}),o(n(h),{sm:24,xs:24,md:24,lg:12},{default:s(()=>[o(n(f),{canExpan:!1},{title:s(()=>[i("div",q,[o(b,{icon:"la:memory"}),J])]),default:s(()=>[o(B,{data:a.memory},null,8,["data"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{me as default};
