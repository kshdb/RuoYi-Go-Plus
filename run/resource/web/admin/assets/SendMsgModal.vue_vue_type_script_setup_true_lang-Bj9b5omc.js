var f=(s,i,a)=>new Promise((l,o)=>{var d=e=>{try{c(a.next(e))}catch(n){o(n)}},m=e=>{try{c(a.throw(e))}catch(n){o(n)}},c=e=>e.done?l(e.value):Promise.resolve(e.value).then(d,m);c((a=a.apply(s,i)).next())});import{a as h,B as M}from"./index-CMSTH4sS.js";import{u as S,_ as v}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{aw as u}from"./entry/index-CMepwc5X-1716790511191.js";import{d as B,f as w,_ as C,a8 as R,a9 as F,k as I,u as r,ad as $}from"./vue-Bw3NQgLF.js";function G(){return u.get({url:"/system/websocket/status"})}function K(s){return u.postWithMsg({url:"/system/websocket/send",data:{message:s}})}function W(s,i){return u.postWithMsg({url:`/system/websocket/send/${s}`,data:{message:i}})}function H(){return u.get({url:"/system/websocket/list"})}function N(s){return u.post({url:"/system/websocket/testEncrypt",data:{message:s}},{encrypt:!0,isTransformResponse:!1})}const O=B({__name:"SendMsgModal",emits:["register","reload"],setup(s,{emit:i}){const a=i,l=w(!0),o=w("发送全体消息"),[d,{modalLoading:m,closeModal:c}]=h(t=>f(this,null,function*(){const{type:p,nickname:k="",sessionKey:_=0}=t;p===1?(l.value=!1,o.value=`发送给${k}的消息`,y({sessionKey:_})):(l.value=!0,o.value="发送全体消息")})),[e,{resetForm:n,validate:g,setFieldsValue:y}]=S({labelWidth:100,showActionButtonGroup:!1,baseColProps:{span:24},schemas:[{field:"msg",component:"Input",label:"消息内容",required:!0},{field:"sessionKey",component:"Input",label:"消息内容",required:!1,show:!1}]});function b(){return f(this,null,function*(){try{m(!0);const t=yield g();r(l)?yield K(t.msg):yield W(t.sessionKey,t.msg),a("reload"),c(),yield n()}catch(t){console.log(t)}finally{m(!1)}})}return(t,p)=>(C(),R(r(M),$(t.$attrs,{width:500,title:o.value,onRegister:r(d),onOk:b,onCancel:r(n)}),{default:F(()=>[I(r(v),{onRegister:r(e)},null,8,["onRegister"])]),_:1},16,["title","onRegister","onCancel"]))}});export{O as _,G as a,N as t,H as w};
