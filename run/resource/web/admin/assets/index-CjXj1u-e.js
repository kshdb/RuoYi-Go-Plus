var c=(D,h,n)=>new Promise((g,u)=>{var b=o=>{try{l(n.next(o))}catch(p){u(p)}},f=o=>{try{l(n.throw(o))}catch(p){u(p)}},l=o=>o.done?g(o.value):Promise.resolve(o.value).then(b,f);l((n=n.apply(D,h)).next())});import{P as I}from"./index-DrfqwNLV.js";import{c as M,d as N,e as x,f as P,g as V}from"./index-BJYj7OZt.js";import{u as L,_ as B}from"./useTable-BlleqRm-.js";import{_ as U}from"./index-Rv_3g2e8.js";import{T as W}from"./TableSwitch-CXPFPejB.js";import{f as A,c as F}from"./tenant.data-CZp0Drjb.js";import{bD as G,I as k,h as K}from"./entry/index-CMepwc5X-1716790511191.js";import{b as j}from"./download-CYeVxFqw.js";import q from"./TenantDrawer-DSZEz7xj.js";import{u as z}from"./index-ov0mgIjt.js";import{p as S}from"./index-De2oYrBu.js";import{d as H,aa as J,n as O,_ as s,a8 as m,a9 as r,k as v,u as e,m as C,G as T,ac as R}from"./vue-Bw3NQgLF.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./antd-BRjMhd0C.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./index-CMSTH4sS.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./rules-Boel_RXz.js";import"./useLoading-iCq4GOHr.js";import"./useSize-tRF5RUOv.js";const ve=H({name:"Tenant",__name:"index",setup(D){const[h,{reload:n,selected:g,multipleRemove:u}]=L({rowSelection:{type:"checkbox",getCheckboxProps:a=>({disabled:a.id===1})},title:"租户列表",rowKey:"id",showIndexColumn:!1,useSearchForm:!0,formConfig:{schemas:A,baseColProps:{xs:24,sm:24,md:24,lg:6},name:"tenant",labelWidth:100,fieldMapToTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},columns:F,api:M,actionColumn:{width:260,fixed:"right",title:"操作",key:"action"}}),[b,{openDrawer:f}]=z(),{createMessage:l}=K();function o(){return c(this,null,function*(){const a=yield S();if(!a.length){l.warning("请先创建租户套餐后重试");return}f(!0,{update:!1,tenantPackageList:a})})}function p(a){return c(this,null,function*(){const i=yield S();f(!0,{update:!0,record:a,tenantPackageList:i})})}function Y(a){return c(this,null,function*(){const{tenantId:i,packageId:d="0"}=a;yield V(i,d),yield n()})}const{initTenant:$}=G();function E(a){return c(this,null,function*(){yield x([a.id]),yield n(),yield $()})}return(a,i)=>{const d=J("a-button"),w=O("auth");return s(),m(e(I),{dense:""},{default:r(()=>[v(e(B),{onRegister:e(h)},{toolbar:r(()=>[C((s(),m(d,{class:"<sm:hidden",onClick:i[0]||(i[0]=y=>e(j)(e(N),"租户信息"))},{default:r(()=>[T("导出")]),_:1})),[[w,"system:tenant:export"]]),C((s(),m(d,{class:"<sm:hidden",type:"primary",danger:"",disabled:!e(g),onClick:i[1]||(i[1]=y=>e(u)(e(x)))},{default:r(()=>[T("删除")]),_:1},8,["disabled"])),[[w,"system:tenant:remove"]]),C((s(),m(d,{type:"primary",onClick:o},{default:r(()=>[T("新增")]),_:1})),[[w,"system:tenant:add"]])]),bodyCell:r(({column:y,record:t})=>[y.key==="status"?(s(),m(e(W),{key:0,modelValue:t.status,"onUpdate:modelValue":_=>t.status=_,disabled:t.id===1,api:()=>e(P)(t),"custom-content":_=>`确认${_}租户[${t.companyName}]吗?`,reload:e(n)},null,8,["modelValue","onUpdate:modelValue","disabled","api","custom-content","reload"])):R("",!0),y.key==="action"?(s(),m(e(U),{key:1,actions:[{label:"修改",icon:e(k).EDIT,type:"primary",ghost:!0,auth:"system:tenant:edit ",onClick:p.bind(null,t),ifShow:t.id!==1},{label:"同步",icon:e(k).SYNC,type:"primary",color:"success",ghost:!0,auth:"system:tenant:edit ",popConfirm:{title:`是否同步[${t.companyName}]的套餐?`,placement:"left",confirm:Y.bind(null,t)},ifShow:t.id!==1},{label:"删除",icon:e(k).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:tenant:delete",ifShow:t.id!==1,popConfirm:{title:`是否删除租户[${t.companyName} - ID: ${t.tenantId}]?`,placement:"left",confirm:E.bind(null,t)}}]},null,8,["actions"])):R("",!0)]),_:1},8,["onRegister"]),v(q,{onRegister:e(b),onReload:e(n)},null,8,["onRegister","onReload"])]),_:1})}}});export{ve as default};
