var k=Object.defineProperty,v=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var g=(e,a,t)=>a in e?k(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,y=(e,a)=>{for(var t in a||(a={}))F.call(a,t)&&g(e,t,a[t]);if(x)for(var t of x(a))E.call(a,t)&&g(e,t,a[t]);return e},C=(e,a)=>v(e,D(a));var p=(e,a,t)=>new Promise((d,c)=>{var u=r=>{try{l(t.next(r))}catch(m){c(m)}},_=r=>{try{l(t.throw(r))}catch(m){c(m)}},l=r=>r.done?d(r.value):Promise.resolve(r.value).then(u,_);l((t=t.apply(e,a)).next())});import{P as R}from"./index-DrfqwNLV.js";import{D as S}from"./index-ByLT-Lkv.js";import{aw as w,C as f,_ as b,I as z}from"./entry/index-CMepwc5X-1716790511191.js";import B from"./MemoryChart-C5iJV94l.js";import I from"./CommandChart-CHptpKae.js";import{u as P}from"./useLoading-iCq4GOHr.js";import{u as L}from"./useDescription-Cm6mcuk5.js";import{d as M,r as N,o as V,aa as $,_ as H,a8 as A,a9 as s,k as o,u as n,a0 as i,G}from"./vue-Bw3NQgLF.js";import{at as K,au as h}from"./antd-BRjMhd0C.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useECharts-zJE5eqwz.js";function O(){return w.get({url:"/monitor/cache"})}const T=[{field:"redis_version",label:"redis版本"},{field:"redis_mode",label:"redis模式",render(e){return e==="standalone"?"单机模式":"集群模式"}},{field:"tcp_port",label:"tcp端口"},{field:"connected_clients",label:"客户端数"},{field:"uptime_in_days",label:"运行时间",render(e){return e+"天"}},{field:"used_memory_human",label:"使用内存"},{field:"used_cpu_user_children",label:"使用CPU",render(e){return parseFloat(e).toFixed(2)}},{field:"maxmemory_human",label:"内存配置"},{field:"aof_enabled",label:"AOF是否开启",render(e){return e==="0"?"否":"是"}},{field:"rdb_last_bgsave_status",label:"RDB是否成功"},{field:"dbSize",label:"Key数量"},{field:"instantaneous_input_kbps",label:"网络入口/出口",render(e,a){const{instantaneous_input_kbps:t,instantaneous_output_kbps:d}=a;return`${t}kps/${d}kps`}}],U={class:"flex gap-1.5"},W=i("span",null,"redis信息",-1),j={class:"flex gap-1.5"},q=i("span",null,"命令统计",-1),J={class:"flex gap-1.5"},Q=i("span",null,"内存占用",-1),me=M({name:"Cache",__name:"index",setup(e){const a=N({memory:"0",command:[]});V(()=>p(this,null,function*(){yield c()}));const[t,d]=P({tip:"加载中..."});function c(){return p(this,null,function*(){try{t();const l=yield O(),r=(parseInt(l.info.used_memory)/1024/1024).toFixed(2);a.memory=r,a.command=l.commandStats,_({data:C(y({},l.info),{dbSize:l.dbSize})})}catch(l){}finally{d()}})}const[u,{setDescProps:_}]=L({column:{xs:1,sm:1,md:3,lg:4,xl:4},schema:T});return(l,r)=>{const m=$("a-button");return H(),A(n(R),{title:"缓存监控"},{default:s(()=>[o(n(K),{gutter:[15,15]},{default:s(()=>[o(n(h),{span:24},{default:s(()=>[o(n(f),{canExpan:!1},{title:s(()=>[i("div",U,[o(b,{icon:"logos:redis",size:14}),W])]),action:s(()=>[o(m,{size:"small",class:"mr-2","pre-icon":n(z).REFRESH,onClick:c},{default:s(()=>[G("刷新")]),_:1},8,["pre-icon"])]),default:s(()=>[o(n(S),{onRegister:n(u)},null,8,["onRegister"])]),_:1})]),_:1}),o(n(h),{sm:24,xs:24,md:24,lg:12},{default:s(()=>[o(n(f),{title:"命令统计",canExpan:!1},{title:s(()=>[i("div",j,[o(b,{icon:"flat-color-icons:command-line"}),q])]),default:s(()=>[o(I,{data:a.command},null,8,["data"])]),_:1})]),_:1}),o(n(h),{sm:24,xs:24,md:24,lg:12},{default:s(()=>[o(n(f),{canExpan:!1},{title:s(()=>[i("div",J,[o(b,{icon:"la:memory"}),Q])]),default:s(()=>[o(B,{data:a.memory},null,8,["data"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{me as default};
