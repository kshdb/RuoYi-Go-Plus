var R=(D,f,n)=>new Promise((y,u)=>{var _=a=>{try{l(n.next(a))}catch(r){u(r)}},h=a=>{try{l(n.throw(a))}catch(r){u(r)}},l=a=>a.done?y(a.value):Promise.resolve(a.value).then(_,h);l((n=n.apply(D,f)).next())});import{P as K}from"./index-DrfqwNLV.js";import{u as P,_ as V}from"./useTable-BlleqRm-.js";import{_ as B}from"./index-Rv_3g2e8.js";import{T as N}from"./TableSwitch-CXPFPejB.js";import{k as U,l as G,m as x,n as L}from"./index-CYdIkwig.js";import{u as F}from"./index-CMSTH4sS.js";import{_ as O}from"./RoleAuthModal.vue_vue_type_script_setup_true_lang-CtcrHJPk.js";import{b as W}from"./download-CYeVxFqw.js";import{f as j,c as q}from"./role.data-DFU5aoTG.js";import{a as z,bC as H,c as J,aU as Q,I as A}from"./entry/index-CMepwc5X-1716790511191.js";import{_ as X}from"./RoleDrawer.vue_vue_type_script_setup_true_lang-HaEXQYRf.js";import{u as Z}from"./index-ov0mgIjt.js";import{ad as ee}from"./antd-BRjMhd0C.js";import{d as oe,c as te,aa as ae,n as ne,_ as s,a8 as m,a9 as i,k as p,u as e,m as C,$ as ie,G as w,ac as S}from"./vue-Bw3NQgLF.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./index-CwwL6bPg.js";import"./useLoading-iCq4GOHr.js";import"./dictEnum-DeC8h6ZR.js";import"./dict-C9gNHjAh.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./index-Bz-s2yf4.js";import"./useSize-tRF5RUOv.js";const Ge=oe({name:"Role",__name:"index",setup(D){const[f,{reload:n,multipleRemove:y,selected:u}]=P({rowSelection:{type:"checkbox",getCheckboxProps:t=>({disabled:t.superAdmin||t.roleKey==="admin"})},title:"角色信息",showIndexColumn:!1,api:U,rowKey:"roleId",useSearchForm:!0,formConfig:{schemas:j,name:"role",baseColProps:{xs:24,sm:24,md:24,lg:6},fieldMapToTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},columns:q,actionColumn:{title:"操作",key:"action",fixed:"right"}}),_=z(),h=te(()=>{var t;return(t=_.userInfo)==null?void 0:t.roles.includes(H.SUPER_ADMIN)}),[l,{openDrawer:a}]=Z(),[r,{openModal:v}]=F();function T(t){v(!0,{record:t})}function E(t){a(!0,{record:t,update:!0})}function I(){a(!0,{update:!1})}const $=J();function M(t){$(`/system/assign-roles/${t}`)}function Y(t){return R(this,null,function*(){yield x([t.roleId]),yield n()})}return(t,d)=>{const k=ae("a-button"),b=ne("auth");return s(),m(e(K),{dense:""},{default:i(()=>[p(e(V),{onRegister:e(f)},{toolbar:i(()=>[p(e(ee),null,{default:i(()=>[C((s(),ie("div",null,[p(e(Q),{placement:"left",title:"确认导出表格吗?",onConfirm:d[0]||(d[0]=c=>e(W)(e(G),"角色信息"))},{default:i(()=>[w("导出")]),_:1})])),[[b,"system:role:export"]]),C((s(),m(k,{type:"primary",danger:"",onClick:d[1]||(d[1]=c=>e(y)(e(x))),disabled:!e(u)},{default:i(()=>[w("删除")]),_:1},8,["disabled"])),[[b,"system:role:remove"]]),C((s(),m(k,{type:"primary",onClick:I},{default:i(()=>[w("新增")]),_:1})),[[b,"system:role:add"]])]),_:1})]),bodyCell:i(({column:c,record:o})=>[c.dataIndex==="status"?(s(),m(e(N),{key:0,modelValue:o.status,"onUpdate:modelValue":g=>o.status=g,disabled:o.roleId===1||o.roleKey==="admin",api:()=>e(L)(o),"custom-content":g=>`确认要${g}角色[${o.roleName}]吗?`,reload:e(n)},null,8,["modelValue","onUpdate:modelValue","disabled","api","custom-content","reload"])):S("",!0),c.key==="action"?(s(),m(e(B),{key:1,stopButtonPropagation:"",dropDownBtnDisplay:"",actions:[{label:"修改",icon:e(A).EDIT,type:"primary",ghost:!0,auth:"system:role:edit",onClick:E.bind(null,o),ifShow:!o.superAdmin&&(o.roleKey!=="admin"||h.value)},{label:"删除",icon:e(A).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:role:remove",ifShow:!o.superAdmin&&o.roleKey!=="admin",popConfirm:{placement:"left",title:`是否删除角色[${o.roleName}]?`,confirm:Y.bind(null,o)}}],dropDownActions:[{label:"数据权限",icon:"mingcute:department-line",auth:"system:role:edit",ifShow:!o.superAdmin&&o.roleKey!=="admin",onClick:T.bind(null,o)},{label:"分配用户",icon:"solar:user-outline",auth:"system:role:edit",ifShow:!o.superAdmin&&o.roleKey!=="admin",onClick:M.bind(null,o.roleId)}]},null,8,["actions","dropDownActions"])):S("",!0)]),_:1},8,["onRegister"]),p(X,{onRegister:e(l),onReload:e(n)},null,8,["onRegister","onReload"]),p(O,{onRegister:e(r),onReload:e(n)},null,8,["onRegister","onReload"])]),_:1})}}});export{Ge as default};
