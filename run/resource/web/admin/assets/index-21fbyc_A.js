var T=(C,u,s)=>new Promise((c,f)=>{var b=o=>{try{i(s.next(o))}catch(l){f(l)}},h=o=>{try{i(s.throw(o))}catch(l){f(l)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(b,h);i((s=s.apply(C,u)).next())});import{P as S}from"./index-DrfqwNLV.js";import{u as $,_ as N}from"./useTable-BlleqRm-.js";import{_ as P}from"./index-Rv_3g2e8.js";import{a as B,f as F}from"./index-Cxb1HX4m.js";import{f as L,c as M,_ as V}from"./DeptModal.vue_vue_type_script_setup_true_lang-DH3_yXpK.js";import{u as z}from"./index-CMSTH4sS.js";import{b as G,bp as K,bz as O,I as y}from"./entry/index-CMepwc5X-1716790511191.js";import{d as W,aa as j,n as q,_,a8 as g,a9 as r,k as d,u as a,ae as H,G as x,m as J,ac as Q,y as U}from"./vue-Bw3NQgLF.js";import{a1 as X}from"./antd-BRjMhd0C.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./index-Cm0AtxlD.js";import"./dictEnum-DeC8h6ZR.js";import"./dict-C9gNHjAh.js";import"./rules-Boel_RXz.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";const Re=W({name:"Dept",__name:"index",setup(C){const u=G("__dept_tip_read",!1),[s,{getRawDataSource:c,expandRows:f,collapseRows:b,expandAll:h,collapseAll:i,reload:o}]=$({title:"部门列表",isTreeTable:!0,showTableSetting:!0,api:B,pagination:!1,rowKey:"deptId",afterFetch(t){const e=K(t,{id:"deptId",pid:"parentId"});return O(e),e},useSearchForm:!0,formConfig:{schemas:L,name:"dept",baseColProps:{xs:24,sm:24,md:24,lg:6}},columns:M,actionColumn:{title:"操作",key:"action",fixed:"right"}});function l(){const t=c();t instanceof Array&&(t.forEach(e=>{e.expand=!0}),U(h))}const[A,{openModal:k}]=z();function D(t){const{deptId:e}=t;k(!0,{deptId:e,update:!0})}function v(t){k(!0,{deptId:t,update:!1})}function R(t){return T(this,null,function*(){yield F(t),yield o()})}function w(t){const e=c();if(e instanceof Array)switch(t){case"expandAll":e.forEach(n=>{n.expand=!0}),h();break;case"collapseAll":e.forEach(n=>{n.expand=!1}),i();break}}function E(t){const{deptId:e}=t;t.expand===!0?(b([e]),t.expand=!1):(f([e]),t.expand=!0)}return(t,e)=>{const n=j("a-button"),I=q("auth");return _(),g(a(S),{dense:""},{default:r(()=>[d(a(N),{onRegister:a(s),onFetchSuccess:l,onRowDbClick:E},H({toolbar:r(()=>[d(n,{class:"<sm:hidden",onClick:e[1]||(e[1]=p=>w("expandAll"))},{default:r(()=>[x("展开")]),_:1}),d(n,{class:"<sm:hidden",onClick:e[2]||(e[2]=p=>w("collapseAll"))},{default:r(()=>[x("折叠")]),_:1}),J((_(),g(n,{type:"primary",onClick:e[3]||(e[3]=p=>v(100))},{default:r(()=>[x(" 新增 ")]),_:1})),[[I,"system:dept:add"]])]),bodyCell:r(({column:p,record:m})=>[p.key==="action"?(_(),g(a(P),{key:0,stopButtonPropagation:"",actions:[{label:"修改",icon:a(y).EDIT,type:"primary",ghost:!0,auth:"system:dept:edit",onClick:D.bind(null,m)},{label:"新增",icon:a(y).ADD,type:"primary",color:"success",ghost:!0,auth:"system:dept:add",onClick:v.bind(null,m.deptId)},{label:"删除",icon:a(y).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:dept:remove",ifShow:()=>m.parentId!==0,popConfirm:{title:`是否删除部门[${m.deptName}]`,placement:"left",confirm:R.bind(null,m.deptId)}}]},null,8,["actions"])):Q("",!0)]),_:2},[a(u)?void 0:{name:"headerTop",fn:r(()=>[d(a(X),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=p=>u.value=!0)})]),key:"0"}]),1032,["onRegister"]),d(V,{onRegister:a(A),onReload:a(o)},null,8,["onRegister","onReload"])]),_:1})}}});export{Re as default};
