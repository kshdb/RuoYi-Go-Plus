var D=(k,l,r)=>new Promise((f,c)=>{var h=o=>{try{p(r.next(o))}catch(m){c(m)}},_=o=>{try{p(r.throw(o))}catch(m){c(m)}},p=o=>o.done?f(o.value):Promise.resolve(o.value).then(h,_);p((r=r.apply(k,l)).next())});import{P}from"./index-DrfqwNLV.js";import{u as M,_ as N}from"./useTable-BlleqRm-.js";import{_ as B}from"./index-Rv_3g2e8.js";import{m as F,d as L}from"./index-Bz-s2yf4.js";import{b as R,bp as V,bz as z,aT as G,I as b}from"./entry/index-CMepwc5X-1716790511191.js";import{t as H,f as K}from"./menu.data-B4OZZc82.js";import{_ as O}from"./MenuDrawer.vue_vue_type_script_setup_true_lang-CGBB0fLf.js";import{u as U}from"./index-ov0mgIjt.js";import{ad as W,T as j,a9 as q,a1 as J}from"./antd-BRjMhd0C.js";import{d as Q,aa as X,n as Y,_ as y,a8 as C,a9 as n,k as s,u as a,ae as Z,H as ee,G as g,m as te,ac as ae}from"./vue-Bw3NQgLF.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./index-CMSTH4sS.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./dict-C9gNHjAh.js";import"./dictEnum-DeC8h6ZR.js";import"./useSize-tRF5RUOv.js";const Me=Q({name:"Menu",__name:"index",setup(k){const l=R("refreshMenu",!0),r=R("__menu_tip_read",!1),[f,{getRawDataSource:c,expandRows:h,collapseRows:_,expandAll:p,collapseAll:o,reload:m}]=M({title:"菜单列表",bordered:!1,api:F,rowKey:"menuId",isTreeTable:!0,columns:H,useSearchForm:!0,formConfig:{baseColProps:{xs:24,sm:24,md:12,lg:6},name:"menu",schemas:K},pagination:!1,afterFetch(t){const e=V(t,{id:"menuId",pid:"parentId"});return z(e),e},actionColumn:{width:230,title:"操作",key:"action",fixed:"right"}}),[T,{openDrawer:w}]=U();function A(t){w(!0,{record:t,update:!0})}function x(t){const e=t?t.menuId:0;w(!0,{record:{parentId:e},update:!1})}const{refreshMenu:E}=G();function I(t){return D(this,null,function*(){yield L([t.menuId]),yield m(),l.value&&(yield E())})}function v(t){const e=c();if(e instanceof Array)switch(t){case"expandAll":e.forEach(i=>{i.expand=!0}),p();break;case"collapseAll":e.forEach(i=>{i.expand=!1}),o();break}}function S(t){const{menuId:e}=t;t.expand===!0?(_([e]),t.expand=!1):(h([e]),t.expand=!0)}return(t,e)=>{const i=X("a-button"),$=Y("auth");return y(),C(a(P),{dense:""},{default:n(()=>[s(a(N),{onRegister:a(f),onRowDbClick:S},Z({toolbar:n(()=>[s(a(W),null,{default:n(()=>[s(a(j),{title:"修改后是否刷新菜单栏"},{default:n(()=>[s(a(q),{checked:a(l),"onUpdate:checked":e[1]||(e[1]=u=>ee(l)?l.value=u:null)},null,8,["checked"])]),_:1}),s(i,{class:"<sm:hidden",onClick:e[2]||(e[2]=u=>v("expandAll"))},{default:n(()=>[g("展开")]),_:1}),s(i,{class:"<sm:hidden",onClick:e[3]||(e[3]=u=>v("collapseAll"))},{default:n(()=>[g("折叠")]),_:1}),te((y(),C(i,{type:"primary",onClick:x},{default:n(()=>[g("新增")]),_:1})),[[$,"system:menu:add"]])]),_:1})]),bodyCell:n(({column:u,record:d})=>[u.key==="action"?(y(),C(a(B),{key:0,stopButtonPropagation:"",actions:[{label:"修改",type:"primary",ghost:!0,icon:a(b).EDIT,onClick:A.bind(null,d),auth:"system:menu:edit"},{label:"新增",icon:a(b).ADD,type:"primary",color:"success",ghost:!0,onClick:x.bind(null,d),auth:"system:menu:add",ifShow:d.menuType!=="F"},{label:"删除",icon:a(b).DELETE,type:"primary",ghost:!0,danger:!0,auth:"system:menu:delete",popConfirm:{title:`是否删除菜单[${d.menuName}]?`,placement:"left",confirm:I.bind(null,d)}}]},null,8,["actions"])):ae("",!0)]),_:2},[a(r)?void 0:{name:"headerTop",fn:n(()=>[s(a(J),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=u=>r.value=!0)})]),key:"0"}]),1032,["onRegister"]),s(O,{onRegister:a(T),onReload:a(m)},null,8,["onRegister","onReload"])]),_:1})}}});export{Me as default};
