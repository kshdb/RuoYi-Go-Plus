var b=(e,s,i)=>new Promise((f,l)=>{var w=a=>{try{d(i.next(a))}catch(n){l(n)}},h=a=>{try{d(i.throw(a))}catch(n){l(n)}},d=a=>a.done?f(a.value):Promise.resolve(a.value).then(w,h);d((i=i.apply(e,s)).next())});import{a as V,B as q}from"./index-ov0mgIjt.js";import{u as H,_ as O}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{bD as A,j as R}from"./entry/index-CMepwc5X-1716790511191.js";import"./helper-CfJJkrf5.js";import"./index-CMSTH4sS.js";import{c as U}from"./rules-Boel_RXz.js";import{n as W,z as x,O as P}from"./antd-BRjMhd0C.js";import{t as L,a as j,b as E}from"./index-BJYj7OZt.js";import{u as $}from"./useSize-tRF5RUOv.js";import{d as G,f as C,c as z,_ as u,a8 as _,a9 as c,k as v,u as t,$ as J,F as K,ab as Q,a0 as S,a1 as D,G as T,ac as X,ad as Z}from"./vue-Bw3NQgLF.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./index-Rv_3g2e8.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useWindowSizeFn-Ba6K9eqp.js";const ee=W(new Date).add(365,"days").startOf("day").format("YYYY-MM-DD HH:mm:ss"),te=[{field:"id",label:"id",component:"Input",show:!1},{field:"tenantId",label:"租户编号",component:"Input",show:!1},{field:"Divider_1",component:"Divider",label:"基本信息",componentProps:{orientation:"center"}},{field:"companyName",label:"企业名称",component:"Input",required:!0},{field:"contactUserName",label:"联系人",component:"Input",required:!0},{field:"contactPhone",label:"联系电话",component:"Input",rules:U("phone",!0)},{field:"Divider_2",component:"Divider",label:"管理员信息",componentProps:{orientation:"center"},ifShow:({model:e})=>!e.tenantId},{field:"username",label:"用户账号",component:"Input",required:!0,ifShow:({model:e})=>!e.tenantId},{field:"password",label:"用户密码",component:"InputPassword",required:!0,ifShow:({model:e})=>!e.tenantId},{field:"Divider_3",component:"Divider",label:"租户设置",componentProps:{orientation:"center"}},{field:"packageId",label:"租户套餐",required:!0,slot:"packageSelect"},{field:"expireTime",label:"过期时间",helpMessage:["已经设置过期时间不允许重置为'无期限'","即在开通时未设置无期限 以后都不允许设置"],component:"DatePicker",defaultValue:ee,componentProps:{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},colProps:{xs:24,sm:24,md:12,lg:12,xl:12}},{field:"accountCount",label:"用户数量",component:"InputNumber",defaultValue:-1,helpMessage:"-1不限制用户数量",componentProps:{min:-1},renderComponentContent({model:e}){return{addonBefore:()=>e.accountCount==-1?"不限制数量":"输入数量"}},colProps:{xs:24,sm:24,md:12,lg:12,xl:12}},{field:"domain",label:"绑定域名",component:"Input",helpMessage:["可填写域名/端口","填写域名如: www.test.com 或者 www.test.com:8080","填写ip:端口如: 127.0.0.1:8080"],componentProps:{addonBefore:"http(s)://"},rules:[{required:!1,message:"绑定域名不需要带http(s)://",trigger:"change",validator(e,s){return s&&(s.startsWith("http://")||s.startsWith("https://"))?Promise.reject(new Error("绑定域名不需要带http(s)://")):Promise.resolve()}}]},{field:"Divider_4",component:"Divider",label:"企业信息",componentProps:{orientation:"center"}},{field:"address",label:"企业地址",component:"Input"},{field:"licenseNumber",label:"企业代码",component:"Input"},{field:"intro",label:"企业介绍",component:"InputTextArea"},{field:"remark",label:"备注",component:"InputTextArea"},{field:"status",label:"状态",component:"Select",defaultValue:"0",show:!1}],ae={class:"flex flex-row items-center gap-1"},oe=["textContent"],ne=G({name:"TenantDrawer",__name:"TenantDrawer",emits:["register","reload"],setup(e,{emit:s}){const i=x.Option,f=s,l=C(!1),w=z(()=>l.value?"编辑租户":"新增租户"),h=$(700),[d,{closeDrawer:a,drawerLoading:n}]=V(r=>b(this,null,function*(){n(!0);const{record:g,update:p,tenantPackageList:m}=r;if(l.value=p,p&&g){const o=yield L(g.id);yield y(o)}I.value=m,n(!1)})),I=C([]),[Y,{setFieldsValue:y,validate:M,resetForm:k}]=H({labelWidth:100,name:"tenant_drawer",showActionButtonGroup:!1,showAdvancedButton:!1,baseColProps:{span:24},schemas:te}),{initTenant:B}=A();function N(){return b(this,null,function*(){try{n(!0);const r=yield M();t(l)?yield j(r):yield E(r),yield B(),f("reload"),a(),yield k()}catch(r){console.log(r)}finally{n(!1)}})}return(r,g)=>(u(),_(t(q),Z(r.$attrs,{title:w.value,width:t(h),showFooter:"",onRegister:t(d),onOk:N,onClose:t(k)}),{default:c(()=>[v(t(O),{onRegister:t(Y)},{packageSelect:c(({model:p,field:m})=>[v(t(x),{value:p[m],"onUpdate:value":o=>p[m]=o,placeholder:"请选择租户套餐",disabled:l.value,allowClear:""},{default:c(()=>[(u(!0),J(K,null,Q(I.value,(o,F)=>(u(),_(t(i),{key:F,value:o.packageId},{default:c(()=>[S("div",ae,[S("span",{textContent:D(o.packageName)},null,8,oe),v(t(P),{color:"blue"},{default:c(()=>[T(" 菜单项目数: "+D(o.menuIds.split(", ").length),1)]),_:2},1024),o.remark?(u(),_(t(P),{key:0,color:"orange"},{default:c(()=>[T(D(o.remark),1)]),_:2},1024)):X("",!0)])]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])]),_:1},8,["onRegister"])]),_:1},16,["title","width","onRegister","onClose"]))}}),Se=R(ne,[["__scopeId","data-v-1ce0dcf5"]]);export{Se as default};
