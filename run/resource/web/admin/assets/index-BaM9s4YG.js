var k=(D,y,i)=>new Promise((s,d)=>{var h=a=>{try{m(i.next(a))}catch(r){d(r)}},_=a=>{try{m(i.throw(a))}catch(r){d(r)}},m=a=>a.done?s(a.value):Promise.resolve(a.value).then(h,_);m((i=i.apply(D,y)).next())});import{P as K}from"./index-C4nZBquz.js";import{u as V,_ as B}from"./useTable-CNbfTOCZ.js";import{_ as N}from"./index-DCvxWw7W.js";import{T as U}from"./TableSwitch-Dq-a_0E1.js";import{k as G,l as L,m as x,n as F}from"./index-DRTL1nQC.js";import{u as O}from"./index-BIkrAlj7.js";import{_ as W}from"./RoleAuthModal.vue_vue_type_script_setup_true_lang-CYfI4jJw.js";import{b as Z}from"./download-DOz9ltI1.js";import{f as j,c as q}from"./role.data-wz2Oc4N6.js";import{i as z,a as H,bE as J,c as Q,aR as X,I as A}from"./entry/index-BbJQUQ84-1718268303552.js";import{_ as ee}from"./RoleDrawer.vue_vue_type_script_setup_true_lang-Bik45guw.js";import{u as oe}from"./index-BLDmWVyR.js";import{aa as te}from"./antd-DMGzOvrA.js";import{d as ae,c as ne,a7 as ie,n as se,Z as l,a8 as p,a9 as n,k as u,u as e,m as w,_ as re,G as C,ab as S}from"./vue-Cw15aJ-2.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./index-BcLdq1Bd.js";import"./useLoading-D1in2ACg.js";import"./dictEnum-DeC8h6ZR.js";import"./dict-vVDMuEaq.js";import"./useRender-D1Q3fAQ3.js";import"./index-Dx0uas1b.js";import"./index-CCBbV1HU.js";import"./useSize-CUNtmCvH.js";const Oe=ae({name:"Role",__name:"index",setup(D){const{hasPermission:y}=z(),[i,{reload:s,multipleRemove:d,selected:h}]=V({rowSelection:{type:"checkbox",getCheckboxProps:t=>({disabled:t.superAdmin||t.roleKey==="admin"})},title:"角色信息",showIndexColumn:!1,api:G,rowKey:"roleId",useSearchForm:!0,formConfig:{schemas:j,name:"role",baseColProps:{xs:24,sm:24,md:24,lg:6},fieldMapToTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},columns:q,actionColumn:{title:"操作",key:"action",fixed:"right"}}),_=H(),m=ne(()=>{var t;return(t=_.userInfo)==null?void 0:t.roles.includes(J.SUPER_ADMIN)}),[a,{openDrawer:r}]=oe(),[v,{openModal:E}]=O();function T(t){E(!0,{record:t})}function I(t){r(!0,{record:t,update:!0})}function M(){r(!0,{update:!1})}const $=Q();function P(t){$(`/system/assign-roles/${t}`)}function Y(t){return k(this,null,function*(){yield x([t.roleId]),yield s()})}return(t,c)=>{const R=ie("a-button"),b=se("auth");return l(),p(e(K),{dense:""},{default:n(()=>[u(e(B),{onRegister:e(i)},{toolbar:n(()=>[u(e(te),null,{default:n(()=>[w((l(),re("div",null,[u(e(X),{placement:"left",title:"确认导出表格吗?",onConfirm:c[0]||(c[0]=f=>e(Z)(e(L),"角色信息"))},{default:n(()=>[C("导出")]),_:1})])),[[b,"system:role:export"]]),w((l(),p(R,{type:"primary",danger:"",onClick:c[1]||(c[1]=f=>e(d)(e(x))),disabled:!e(h)},{default:n(()=>[C("删除")]),_:1},8,["disabled"])),[[b,"system:role:remove"]]),w((l(),p(R,{type:"primary",onClick:M},{default:n(()=>[C("新增")]),_:1})),[[b,"system:role:add"]])]),_:1})]),bodyCell:n(({column:f,record:o})=>[f.dataIndex==="status"?(l(),p(e(U),{key:0,modelValue:o.status,"onUpdate:modelValue":g=>o.status=g,disabled:o.roleId===1||o.roleKey==="admin"||!e(y)("system:role:edit"),api:()=>e(F)(o),"custom-content":g=>`确认要${g}角色[${o.roleName}]吗?`,reload:e(s)},null,8,["modelValue","onUpdate:modelValue","disabled","api","custom-content","reload"])):S("",!0),f.key==="action"?(l(),p(e(N),{key:1,stopButtonPropagation:"",dropDownBtnDisplay:"",actions:[{label:"修改",icon:e(A).EDIT,type:"primary",ghost:!0,auth:"system:role:edit",onClick:I.bind(null,o),ifShow:!o.superAdmin&&(o.roleKey!=="admin"||m.value)},{label:"删除",icon:e(A).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:role:remove",ifShow:!o.superAdmin&&o.roleKey!=="admin",popConfirm:{placement:"left",title:`是否删除角色[${o.roleName}]?`,confirm:Y.bind(null,o)}}],dropDownActions:[{label:"数据权限",icon:"mingcute:department-line",auth:"system:role:edit",ifShow:!o.superAdmin&&o.roleKey!=="admin",onClick:T.bind(null,o)},{label:"分配用户",icon:"solar:user-outline",auth:"system:role:edit",ifShow:!o.superAdmin&&o.roleKey!=="admin",onClick:P.bind(null,o.roleId)}]},null,8,["actions","dropDownActions"])):S("",!0)]),_:1},8,["onRegister"]),u(ee,{onRegister:e(a),onReload:e(s)},null,8,["onRegister","onReload"]),u(W,{onRegister:e(v),onReload:e(s)},null,8,["onRegister","onReload"])]),_:1})}}});export{Oe as default};
