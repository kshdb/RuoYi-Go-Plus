var u=(l,d,s)=>new Promise((y,g)=>{var h=n=>{try{c(s.next(n))}catch(f){g(f)}},p=n=>{try{c(s.throw(n))}catch(f){g(f)}},c=n=>n.done?y(n.value):Promise.resolve(n.value).then(h,p);c((s=s.apply(l,d)).next())});import{P as D}from"./index-C4nZBquz.js";import{_ as E}from"./index-BcLdq1Bd.js";import{a as R}from"./index-C0XwB-DV.js";import{i as T,c as V,e as N}from"./index-m3nShAF-.js";import{u as P,_ as F}from"./useTable-CNbfTOCZ.js";import{_}from"./index-DCvxWw7W.js";import{u as K}from"./useRender-D1Q3fAQ3.js";import{D as B}from"./dictEnum-DeC8h6ZR.js";import{bw as A,bj as W,bx as $,c as L,I as b,l as U}from"./entry/index-BbJQUQ84-1718268303552.js";import{ar as M,as as S,y as q}from"./antd-DMGzOvrA.js";import{d as j,f as I,r as z,o as G,Z as w,a8 as k,a9 as m,k as r,u as a,ac as H,ab as x,ak as Z,al as J,_ as O,F as Q}from"./vue-Cw15aJ-2.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./index-BIkrAlj7.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./download-DOz9ltI1.js";import"./useLoading-D1in2ACg.js";import"./index-Dx0uas1b.js";import"./dict-vVDMuEaq.js";const{renderDict:X}=K(),Y=[{dataIndex:"processDefinitionName",title:"流程名称"},{dataIndex:"processDefinitionKey",title:"流程key"},{dataIndex:"processDefinitionVersion",title:"版本号",customRender({value:l}){return`V${l}.0`}},{dataIndex:"businessStatus",title:"流程状态",customRender({value:l}){return X(l,B.WF_BUSINESS_STATUS)}},{dataIndex:"startTime",title:"启动时间"}],ee=[{field:"name",label:"流程名称",component:"Input"}],te=j({__name:"myDocument",setup(l){const d=I(""),s=z({tree:[],selectId:[]}),y=I(!0);function g(){return u(this,null,function*(){yield p()})}G(()=>u(this,null,function*(){const e=yield R();let t=A(e,{id:"id",pid:"parentId"});t=[{categoryName:"根目录",id:0,children:t}],W(t,i=>{i.icon="flat-color-icons:folder"}),$(t,"categoryName"," / "),s.tree=t,y.value=!1}));const[h,{reload:p}]=P({rowSelection:{type:"checkbox"},title:"我发起的流程列表",showIndexColumn:!1,api:T,rowKey:"id",useSearchForm:!0,formConfig:{schemas:ee,baseColProps:{xs:24,sm:24,md:24,lg:6},labelWidth:80,resetFunc:()=>u(this,null,function*(){s.selectId=[],d.value=""})},columns:Y,beforeFetch(e){return s.selectId.length===1&&(e.categoryCode=s.selectId[0]),e},actionColumn:{width:220,title:"操作",key:"action",fixed:"right"}}),c=L();function n(e){const t=e.wfNodeConfigVo.wfFormManageVo.router;c({path:t,query:{id:e.businessKey,type:"preview"}})}function f(e){return u(this,null,function*(){yield V(e.businessKey),yield p()})}function C(e){const t=e.wfNodeConfigVo.wfFormManageVo.router;c({path:t,query:{id:e.businessKey,type:"update"}})}function v(e){return u(this,null,function*(){yield N([e.businessKey]),yield p()})}return(e,t)=>(w(),k(a(D),{dense:""},{default:m(()=>[r(a(M),null,{default:m(()=>[r(a(S),H({xs:24,sm:24,md:24,lg:4},{class:"h-[calc(100vh-80px)]"}),{default:m(()=>[r(a(q),{active:!0,paragraph:{rows:8},loading:y.value},{default:m(()=>[s.tree.length?(w(),k(a(E),{key:0,fieldNames:{title:"categoryName",key:"categoryCode"},"tree-data":s.tree,showLine:{showLeafIcon:!1},search:!0,searchValue:d.value,"onUpdate:searchValue":t[0]||(t[0]=i=>d.value=i),defaultExpandAll:"",onSelect:g,selectedKeys:s.selectId,"onUpdate:selectedKeys":t[1]||(t[1]=i=>s.selectId=i)},null,8,["tree-data","searchValue","selectedKeys"])):x("",!0)]),_:1},8,["loading"])]),_:1},16),r(a(S),Z(J({xs:24,sm:24,md:24,lg:20})),{default:m(()=>[r(a(F),{onRegister:a(h)},{bodyCell:m(({column:i,record:o})=>[i.key==="action"?(w(),O(Q,{key:0},[r(a(_),{stopButtonPropagation:"",actions:[{label:"记录",icon:a(b).PREVIEW,onClick:n.bind(null,o)},{label:"重新提交",icon:a(b).EDIT,onClick:C.bind(null,o),ifShow:o.businessStatus==="draft"||o.businessStatus==="cancel"||o.businessStatus==="back"}]},null,8,["actions"]),r(a(_),{stopButtonPropagation:"",actions:[{label:"删除",icon:a(b).PREVIEW,danger:!0,popConfirm:{title:"是否确认删除",placement:"left",confirm:v.bind(null,o)},ifShow:o.businessStatus==="draft"||o.businessStatus==="cancel"||o.businessStatus==="back"},{label:"撤销",icon:a(b).DELETE,danger:!0,popConfirm:{placement:"left",title:`是否确认撤销[${o.processDefinitionName}]流程?`,confirm:f.bind(null,o)},ifShow:o.businessStatus==="waiting"}]},null,8,["actions"])],64)):x("",!0)]),_:1},8,["onRegister"])]),_:1},16)]),_:1})]),_:1}))}}),Ne=U(te,[["__scopeId","data-v-a982fe70"]]);export{Ne as default};
