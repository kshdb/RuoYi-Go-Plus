var T=(s,c,i)=>new Promise((f,h)=>{var b=o=>{try{l(i.next(o))}catch(p){h(p)}},y=o=>{try{l(i.throw(o))}catch(p){h(p)}},l=o=>o.done?f(o.value):Promise.resolve(o.value).then(b,y);l((i=i.apply(s,c)).next())});import{P as $}from"./index-DrfqwNLV.js";import{u as M,_ as N}from"./useTable-BlleqRm-.js";import{_ as P}from"./index-Rv_3g2e8.js";import{aw as A,b as B,bp as F,bz as L,I as g}from"./entry/index-CMepwc5X-1716790511191.js";import{f as V,c as z,_ as W}from"./DeptModal.vue_vue_type_script_setup_true_lang-Dz1Re4XX.js";import{u as G}from"./index-CMSTH4sS.js";import{d as H,aa as K,n as O,_,a8 as x,a9 as r,k as u,u as a,ae as j,G as C,m as q,ac as J,y as Q}from"./vue-Bw3NQgLF.js";import{a1 as U}from"./antd-BRjMhd0C.js";import"./useContentViewHeight-xBSq9xFC.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useForm-uR1ZVBCA.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./componentMap-DPcekmXH.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./helper-CfJJkrf5.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./index-Cxb1HX4m.js";import"./index-Cm0AtxlD.js";import"./dictEnum-DeC8h6ZR.js";import"./dict-C9gNHjAh.js";import"./rules-Boel_RXz.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";function X(s){return A.get({url:"/zhongkong/dept/list",params:s})}function Y(s){return A.deleteWithMsg({url:"/system/dept/"+s})}const Ee=H({name:"Dept",__name:"index",setup(s){const c=B("__dept_tip_read",!1),[i,{getRawDataSource:f,expandRows:h,collapseRows:b,expandAll:y,collapseAll:l,reload:o}]=M({title:"部门列表",isTreeTable:!0,showTableSetting:!0,api:X,pagination:!1,rowKey:"deptId",afterFetch(t){const e=F(t,{id:"deptId",pid:"parentId"});return L(e),e},useSearchForm:!0,formConfig:{schemas:V,name:"dept",baseColProps:{xs:24,sm:24,md:24,lg:6}},columns:z,actionColumn:{title:"操作",key:"action",fixed:"right"}});function p(){const t=f();t instanceof Array&&(t.forEach(e=>{e.expand=!0}),Q(y))}const[D,{openModal:k}]=G();function R(t){const{deptId:e}=t;k(!0,{deptId:e,update:!0})}function v(t){k(!0,{deptId:t,update:!1})}function E(t){return T(this,null,function*(){yield Y(t),yield o()})}function w(t){const e=f();if(e instanceof Array)switch(t){case"expandAll":e.forEach(n=>{n.expand=!0}),y();break;case"collapseAll":e.forEach(n=>{n.expand=!1}),l();break}}function I(t){const{deptId:e}=t;t.expand===!0?(b([e]),t.expand=!1):(h([e]),t.expand=!0)}return(t,e)=>{const n=K("a-button"),S=O("auth");return _(),x(a($),{dense:""},{default:r(()=>[u(a(N),{onRegister:a(i),onFetchSuccess:p,onRowDbClick:I},j({toolbar:r(()=>[u(n,{class:"<sm:hidden",onClick:e[1]||(e[1]=d=>w("expandAll"))},{default:r(()=>[C("展开")]),_:1}),u(n,{class:"<sm:hidden",onClick:e[2]||(e[2]=d=>w("collapseAll"))},{default:r(()=>[C("折叠")]),_:1}),q((_(),x(n,{type:"primary",onClick:e[3]||(e[3]=d=>v(100))},{default:r(()=>[C(" 新增 ")]),_:1})),[[S,"system:dept:add"]])]),bodyCell:r(({column:d,record:m})=>[d.key==="action"?(_(),x(a(P),{key:0,stopButtonPropagation:"",actions:[{label:"修改",icon:a(g).EDIT,type:"primary",ghost:!0,auth:"system:dept:edit",onClick:R.bind(null,m)},{label:"新增",icon:a(g).ADD,type:"primary",color:"success",ghost:!0,auth:"system:dept:add",onClick:v.bind(null,m.deptId)},{label:"删除",icon:a(g).DELETE,type:"primary",danger:!0,ghost:!0,auth:"system:dept:remove",ifShow:()=>m.parentId!==0,popConfirm:{title:`是否删除部门[${m.deptName}]`,placement:"left",confirm:E.bind(null,m.deptId)}}]},null,8,["actions"])):J("",!0)]),_:2},[a(c)?void 0:{name:"headerTop",fn:r(()=>[u(a(U),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=d=>c.value=!0)})]),key:"0"}]),1032,["onRegister"]),u(W,{onRegister:a(D),onReload:a(o)},null,8,["onRegister","onReload"])]),_:1})}}});export{Ee as default};
