var d=(o,n,a)=>new Promise((u,i)=>{var s=e=>{try{r(a.next(e))}catch(l){i(l)}},g=e=>{try{r(a.throw(e))}catch(l){i(l)}},r=e=>e.done?u(e.value):Promise.resolve(e.value).then(s,g);r((a=a.apply(o,n)).next())});import{a as k,B as C}from"./index-BIkrAlj7.js";import{u as v,_ as B}from"./useForm-BsovIqMX.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./componentMap-qA-f8iV4.js";import{aA as w,h as M}from"./entry/index-BbJQUQ84-1718268303552.js";import{d as N,Z as $,a8 as F,a9 as D,k as O,u as m,ac as R}from"./vue-Cw15aJ-2.js";function T(o){return w.get({url:"/workflow/definitionConfig/getByDefId/"+o})}function I(o){return w.postWithMsg({url:"/workflow/definitionConfig/saveOrUpdate",data:o})}function x(o,n){return w.get({url:`/workflow/definitionConfig/getByTableNameNotDefId/${o}/${n}`})}const H=N({__name:"FormConfigModal",emits:["register","reload"],setup(o,{emit:n}){const a=n,[u,{modalLoading:i,closeModal:s}]=k(g);function g(t){return d(this,null,function*(){const{key:c,id:f}=t,_={processKey:c,definitionId:f,version:t.version},y=yield T(f);y?yield e(y):yield e(_)})}const[r,{setFieldsValue:e,validate:l,resetForm:p}]=v({baseColProps:{span:24},labelWidth:100,layout:"vertical",name:"form_config_form",showActionButtonGroup:!1,schemas:[{label:"表单id",field:"id",component:"Input",show:!1},{label:"定义ID",field:"definitionId",component:"Input",show:!1},{label:"版本",field:"version",component:"Input",show:!1},{label:"流程key",field:"processKey",component:"Input",componentProps:{disabled:!0}},{label:"表名",field:"tableName",component:"Input"},{label:"备注",field:"remark",component:"InputTextArea"}]}),{createConfirm:b}=M();function h(){return d(this,null,function*(){try{i(!0);const t=yield l(),c=yield x(t.tableName,t.definitionId);if(c.length>0){let _;const f=c[0];b({title:"提示",iconType:"warning",content:`表名已被[${f.processKey}] v${f.version} 绑定, 确认后会被替换`,onOk(){return d(this,null,function*(){yield I(t),a("reload"),s(),yield p()})},onCancel(){return d(this,null,function*(){s(),yield p()})}})}else yield I(t),a("reload"),s(),yield p()}catch(t){}finally{i(!1)}})}return(t,c)=>($(),F(m(C),R(t.$attrs,{title:"表单配置",width:600,"can-fullscreen":!1,onRegister:m(u),onOk:h,onCancel:m(p)}),{default:D(()=>[O(m(B),{onRegister:m(r)},null,8,["onRegister"])]),_:1},16,["onRegister","onCancel"]))}});export{H as _};
