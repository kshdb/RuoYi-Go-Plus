var d=(e,f,a)=>new Promise((r,c)=>{var p=o=>{try{i(a.next(o))}catch(m){c(m)}},n=o=>{try{i(a.throw(o))}catch(m){c(m)}},i=o=>o.done?r(o.value):Promise.resolve(o.value).then(p,n);i((a=a.apply(e,f)).next())});import{a as I,B as R}from"./index-BIkrAlj7.js";import{u as x,_ as T}from"./useForm-BsovIqMX.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./componentMap-qA-f8iV4.js";import{a as N,b as k,c as B}from"./index-CJTZaHOu.js";import{u as C}from"./useRender-D1Q3fAQ3.js";import{D as h}from"./dictEnum-DeC8h6ZR.js";import{g as E}from"./dict-vVDMuEaq.js";import{d as P,f as q,c as S,W as v,Z as D,a8 as O,a9 as V,k as W,u as s,ac as A}from"./vue-Cw15aJ-2.js";import{h as G}from"./entry/index-BbJQUQ84-1718268303552.js";const te=[{label:"表单名称",field:"formName",component:"Input"}],{renderDict:U}=C(),ae=[{title:"表单名称",dataIndex:"formName"},{title:"表单类型",dataIndex:"formType",customRender({value:e}){return U(e,h.WF_FORM_TYPE)}},{title:"地址",dataIndex:"router"},{title:"备注",dataIndex:"remark"}],Y=[{label:"主键",field:"id",component:"Input",show:!1},{label:"表单名称",field:"formName",required:!0,component:"Input"},{label:"表单类型",field:"formType",required:!0,defaultValue:"static",component:"RadioButtonGroup",componentProps({formActionType:e}){return{options:E(h.WF_FORM_TYPE),onChange(a){return d(this,null,function*(){if(typeof a!="string")return;const r=a;e.updateSchema([{field:"router",required:r==="static"},{field:"formTypeName",required:r==="dynamic"}]),yield e.clearValidate(["router","formTypeName"])})}}}},{label:"路由地址",field:"router",required:!0,component:"Input",show({model:e}){return e.formType==="static"}},{label:"表单",field:"formTypeName",component:"Select",componentProps:{disabled:!0,placeholder:"暂不支持"},show({model:e}){return e.formType==="dynamic"}},{label:"备注",field:"remark",component:"InputTextArea"}],oe=P({name:"FormManageModal",__name:"FormManageModal",emits:["register","reload"],setup(e,{emit:f}){const a=f,r=q(!1),c=S(()=>r.value?"编辑表单配置":"新增表单配置"),[p,{modalLoading:n,closeModal:i}]=I(t=>d(this,null,function*(){n(!0);const{record:l,update:u}=t;if(r.value=u,u&&l){const b=yield N(l.id);yield m(b)}n(!1)})),[o,{setFieldsValue:m,resetForm:g,validate:y}]=x({labelWidth:100,showActionButtonGroup:!1,baseColProps:{span:24},schemas:Y}),_=v();function w(t){return _.getRoutes().find(u=>u.path===t)}const{createMessage:M}=G();function F(){return d(this,null,function*(){try{n(!0);const t=yield y();if(t.formType==="static"&&!w(t.router)){M.error({content:"路由地址不存在, 添加后重试!"});return}s(r)?yield k(t):yield B(t),a("reload"),i(),yield g()}catch(t){}finally{n(!1)}})}return(t,l)=>(D(),O(s(R),A(t.$attrs,{title:c.value,onRegister:s(p),onOk:F,onCancel:s(g)}),{default:V(()=>[W(s(T),{onRegister:s(o)},null,8,["onRegister"])]),_:1},16,["title","onRegister","onCancel"]))}});export{oe as _,ae as c,te as f};
