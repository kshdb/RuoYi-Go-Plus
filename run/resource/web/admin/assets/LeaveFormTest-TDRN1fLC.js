var c=(k,g,t)=>new Promise((p,l)=>{var v=r=>{try{m(t.next(r))}catch(d){l(d)}},i=r=>{try{m(t.throw(r))}catch(d){l(d)}},m=r=>r.done?p(r.value):Promise.resolve(r.value).then(v,i);m((t=t.apply(k,g)).next())});import{d as V,ao as L,f as y,o as N,c as W,aa as A,_ as f,a8 as x,a9 as u,k as n,m as h,A as R,u as e,$ as Y,G as T,ac as w}from"./vue-Bw3NQgLF.js";import{u as G,_ as j}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{g as q,m as E,u as K,a as O}from"./api-TODdotqz.js";import{P as z}from"./index-DrfqwNLV.js";import{i as H,C as $}from"./entry/index-CMepwc5X-1716790511191.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-B0DykFdS.js";import{u as Q}from"./index-CMSTH4sS.js";import{s as U}from"./index-D8V_F1G-.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-DRhFpVAF.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-Buuxga5c.js";import{y as tt,o as et}from"./antd-BRjMhd0C.js";import"./FormItem.vue_vue_type_script_lang-DAyz6oLf.js";import"./helper-CfJJkrf5.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DgvCFV63.js";import"./index-Rv_3g2e8.js";import"./useSortable-CwI952Jx.js";import"./download-CYeVxFqw.js";import"./useLoading-iCq4GOHr.js";import"./copyTextToClipboard-BLtSw0o7.js";import"./onMountedOrActivated-B2y-oH2N.js";import"./useRender-C6p2srTi.js";import"./index-BhefpKLc.js";import"./useWindowSizeFn-Ba6K9eqp.js";import"./dict-C9gNHjAh.js";import"./common-BAk3Wc0g.js";import"./useContentViewHeight-xBSq9xFC.js";import"./index-BMkdtMeE.js";import"./index-CwwL6bPg.js";import"./index-Cm0AtxlD.js";import"./useTable-BlleqRm-.js";import"./sortable.esm-DFFrMEeC.js";import"./dictEnum-DeC8h6ZR.js";import"./index-CU-vYa55.js";import"./index-JVPtXpd4.js";import"./index-Cvdu3VMw.js";import"./index-u_3lW7KD.js";import"./RejectModal.vue_vue_type_script_setup_true_lang-BGCtAQaM.js";const at={key:0,class:"flex justify-end gap-8px mt-8px"},ot={key:2},Et=V({__name:"LeaveFormTest",setup(k){const t=L().query,p=y(""),l=y(!1);N(()=>c(this,null,function*(){l.value=!0;const{type:a,id:o=""}=t;if(a){if(a==="preview"||a==="update"||a==="approval"){yield B({disabled:a==="preview"||a==="approval"});const s=yield q(o);p.value=s.processInstanceVo.id,s.dateTime=[s.startDate,s.endDate],yield r(s)}l.value=!1}}));const v=W(()=>{const{type:a}=t;return a==="add"||a==="update"}),i=y(!1),[m,{setFieldsValue:r,validate:d,setProps:B}]=G({labelWidth:100,name:"leave_form",showActionButtonGroup:!1,baseColProps:{xs:24,sm:24,md:24,lg:12},schemas:E,fieldMapToTime:[["dateTime",["startDate","endDate"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 00:00:00"]]]}),{closeCurrent:b}=H(),[F,{openModal:P}]=Q();function I(a){return c(this,null,function*(){try{i.value=!0;const o=yield d(),s=et(o,"version"),_=yield(t.type==="update"?K:O)(s);if(a==="temp"){yield b();return}const M={businessKey:_.id,tableName:"test_leave",variables:{entity:_,leaveDays:_.leaveDays,userList:[1,3],userList2:[1,3]}};console.log(M);const S=yield U(M);P(!0,S.taskId)}catch(o){console.warn(o)}finally{i.value=!1}})}function C(){return c(this,null,function*(){yield b()})}return(a,o)=>{const s=A("a-button");return f(),x(e(z),{dense:"",contentClass:"p-16px"},{default:u(()=>[n(e($),{title:"表单信息"},{default:u(()=>[h(n(e(tt),{active:""},null,512),[[R,l.value]]),h(n(e(j),{onRegister:e(m)},null,8,["onRegister"]),[[R,!l.value]])]),_:1}),v.value?(f(),Y("div",at,[n(s,{loading:i.value,disabled:i.value,onClick:o[0]||(o[0]=D=>I("temp"))},{default:u(()=>[T("保存草稿")]),_:1},8,["loading","disabled"]),n(s,{loading:i.value,disabled:i.value,type:"primary",onClick:o[1]||(o[1]=D=>I("submit"))},{default:u(()=>[T("提交")]),_:1},8,["loading","disabled"])])):w("",!0),e(t).type==="approval"&&e(t).taskId?(f(),x(e($),{key:1,class:"mt-16px",title:"审批"},{default:u(()=>[n(Z,{class:"md:w-full lg:w-1/2",taskId:e(t).taskId,onReload:C},null,8,["taskId"])]),_:1})):w("",!0),e(t).type!=="add"&&e(t).type!=="update"&&p.value?(f(),Y("div",ot,[n(X,{instanceId:p.value},null,8,["instanceId"])])):w("",!0),n(J,{approvalMode:e(t).type==="approval",taskId:e(t).taskId,onRegister:e(F),onReload:C},null,8,["approvalMode","taskId","onRegister"])]),_:1})}}});export{Et as default};
