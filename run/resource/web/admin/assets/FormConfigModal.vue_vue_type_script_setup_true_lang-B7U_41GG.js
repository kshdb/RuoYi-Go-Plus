var f=(o,a,n)=>new Promise((p,i)=>{var m=e=>{try{s(n.next(e))}catch(r){i(r)}},u=e=>{try{s(n.throw(e))}catch(r){i(r)}},s=e=>e.done?p(e.value):Promise.resolve(e.value).then(m,u);s((n=n.apply(o,a)).next())});import{a as h,B as k}from"./index-CMSTH4sS.js";import{u as C,_ as v}from"./useForm-uR1ZVBCA.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BxZ9HtKh.js";import"./componentMap-DPcekmXH.js";import{aw as w,h as B}from"./entry/index-CMepwc5X-1716790511191.js";import{d as M,_ as N,a8 as $,a9 as F,k as D,u as d,ad as O}from"./vue-Bw3NQgLF.js";function R(o){return w.get({url:"/workflow/definitionConfig/getByDefId/"+o})}function T(o){return w.postWithMsg({url:"/workflow/definitionConfig/saveOrUpdate",data:o})}function x(o,a){return w.get({url:`/workflow/definitionConfig/getByTableNameNotDefId/${o}/${a}`})}const H=M({__name:"FormConfigModal",emits:["register","reload"],setup(o,{emit:a}){const n=a,[p,{modalLoading:i,closeModal:m}]=h(u);function u(t){return f(this,null,function*(){const{key:l,id:c}=t,_={processKey:l,definitionId:c,version:t.version},y=yield R(c);y?yield e(y):yield e(_)})}const[s,{setFieldsValue:e,validate:r,resetForm:g}]=C({baseColProps:{span:24},labelWidth:100,layout:"vertical",name:"form_config_form",showActionButtonGroup:!1,schemas:[{label:"表单id",field:"id",component:"Input",show:!1},{label:"定义ID",field:"definitionId",component:"Input",show:!1},{label:"版本",field:"version",component:"Input",show:!1},{label:"流程key",field:"processKey",component:"Input",componentProps:{disabled:!0}},{label:"表名",field:"tableName",component:"Input"},{label:"备注",field:"remark",component:"InputTextArea"}]}),{createConfirm:I}=B();function b(){return f(this,null,function*(){try{i(!0);const t=yield r(),l=yield x(t.tableName,t.definitionId);if(l.length>0){let _;const c=l[0];I({title:"提示",iconType:"warning",content:`表名已被[${c.processKey}] v${c.version} 绑定, 确认后会被替换`,onOk(){return f(this,null,function*(){yield T(t),n("reload"),m(),yield g()})},onCancel(){return f(this,null,function*(){m(),yield g()})}})}}catch(t){}finally{i(!1)}})}return(t,l)=>(N(),$(d(k),O(t.$attrs,{title:"表单配置",width:600,"can-fullscreen":!1,onRegister:d(p),onOk:b,onCancel:d(g)}),{default:F(()=>[D(d(v),{onRegister:d(s)},null,8,["onRegister"])]),_:1},16,["onRegister","onCancel"]))}});export{H as _};
