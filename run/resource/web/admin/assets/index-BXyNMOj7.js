var E=(C,m,i)=>new Promise((u,d)=>{var k=a=>{try{l(i.next(a))}catch(p){d(p)}},f=a=>{try{l(i.throw(a))}catch(p){d(p)}},l=a=>a.done?u(a.value):Promise.resolve(a.value).then(k,f);l((i=i.apply(C,m)).next())});import{P as I}from"./index-C4nZBquz.js";import{u as N,_ as P}from"./useTable-CNbfTOCZ.js";import{_ as B}from"./index-DCvxWw7W.js";import{a as F,e as L,f as M}from"./index-C0XwB-DV.js";import{b as V}from"./download-DOz9ltI1.js";import{f as q,c as G,_ as K}from"./CategoryModal.vue_vue_type_script_setup_true_lang-CR-nx_Du.js";import{u as O}from"./index-BIkrAlj7.js";import{b as W,bw as Z,bA as j,I as x}from"./entry/index-BbJQUQ84-1718268303552.js";import{d as z,a7 as H,n as J,Z as y,a8 as b,a9 as n,k as c,u as t,ad as Q,G as w,m as T,ab as U,y as X}from"./vue-Cw15aJ-2.js";import{aq as Y}from"./antd-DMGzOvrA.js";import"./useContentViewHeight-BDi3O9lC.js";import"./useWindowSizeFn-BKs0NEK5.js";import"./onMountedOrActivated-CSHfHTyc.js";import"./useForm-BsovIqMX.js";import"./FormItem.vue_vue_type_script_lang-C67_1cA1.js";import"./componentMap-qA-f8iV4.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-SetVOuUZ.js";import"./copyTextToClipboard-uEEWQikS.js";import"./style-CLEvKZSv.js";import"./helper-CXVLNTBN.js";import"./BasicForm.vue_vue_type_style_index_0_lang-B6-8R5aw.js";import"./sortable.esm-DFFrMEeC.js";import"./useSortable-BTdBE9Oa.js";import"./useLoading-D1in2ACg.js";const Ae=z({name:"Category",__name:"index",setup(C){const m=W("category.read",!1),[i,{getRawDataSource:u,expandRows:d,collapseRows:k,expandAll:f,collapseAll:l,reload:a}]=N({title:"流程分类列表",isTreeTable:!0,showTableSetting:!0,api:F,pagination:!1,rowKey:"id",afterFetch(o){const e=Z(o,{id:"id",pid:"parentId"});return j(e),e},useSearchForm:!0,formConfig:{schemas:q,baseColProps:{xs:24,sm:24,md:24,lg:6}},columns:G,actionColumn:{title:"操作",key:"action",fixed:"right"}});function p(){const o=u();o instanceof Array&&(o.forEach(e=>{e.expand=!0}),X(f))}const[R,{openModal:h}]=O();function D(o){const{id:e}=o;h(!0,{id:e,update:!0})}function _(o){h(!0,{id:o,update:!1})}function S(o){return E(this,null,function*(){yield M([o]),yield a()})}function v(o){const e=u();if(e instanceof Array)switch(o){case"expandAll":e.forEach(r=>{r.expand=!0}),f();break;case"collapseAll":e.forEach(r=>{r.expand=!1}),l();break}}function $(o){const{id:e}=o;o.expand===!0?(k([e]),o.expand=!1):(d([e]),o.expand=!0)}return(o,e)=>{const r=H("a-button"),A=J("auth");return y(),b(t(I),{dense:""},{default:n(()=>[c(t(P),{onRegister:t(i),onFetchSuccess:p,onRowDbClick:$},Q({toolbar:n(()=>[c(r,{onClick:e[1]||(e[1]=s=>v("expandAll"))},{default:n(()=>[w("展开")]),_:1}),c(r,{onClick:e[2]||(e[2]=s=>v("collapseAll"))},{default:n(()=>[w("折叠")]),_:1}),T((y(),b(r,{onClick:e[3]||(e[3]=s=>t(V)(t(L),"流程分类"))},{default:n(()=>[w("导出")]),_:1})),[[A,"workflow:category:export"]]),T((y(),b(r,{type:"primary",onClick:e[4]||(e[4]=s=>_(0))},{default:n(()=>[w(" 新增 ")]),_:1})),[[A,"workflow:category:add"]])]),bodyCell:n(({column:s,record:g})=>[s.key==="action"?(y(),b(t(B),{key:0,stopButtonPropagation:"",actions:[{label:"修改",icon:t(x).EDIT,type:"primary",ghost:!0,auth:"workflow:category:edit",onClick:D.bind(null,g)},{label:"新增",icon:t(x).ADD,type:"primary",color:"success",ghost:!0,auth:"workflow:category:add",onClick:_.bind(null,g.id)},{label:"删除",icon:t(x).DELETE,type:"primary",danger:!0,ghost:!0,auth:"workflow:category:remove",popConfirm:{title:`是否删除分类[${g.categoryName}]`,placement:"left",confirm:S.bind(null,g.id)}}]},null,8,["actions"])):U("",!0)]),_:2},[t(m)?void 0:{name:"headerTop",fn:n(()=>[c(t(Y),{class:"h-30px",message:"提示: 双击行可展开/折叠内容",type:"info",banner:"",closable:"",onClose:e[0]||(e[0]=s=>m.value=!0)})]),key:"0"}]),1032,["onRegister"]),c(K,{onRegister:t(R),onReload:t(a)},null,8,["onRegister","onReload"])]),_:1})}}});export{Ae as default};
