var T=(M,_,c)=>new Promise((x,i)=>{var v=l=>{try{s(c.next(l))}catch(p){i(p)}},u=l=>{try{s(c.throw(l))}catch(p){i(p)}},s=l=>l.done?x(l.value):Promise.resolve(l.value).then(v,u);s((c=c.apply(M,_)).next())});import{a as D,B as F}from"./index-CMSTH4sS.js";import{p as S}from"./index-CT23NofX.js";import{M as n,C as V}from"./index-BhefpKLc.js";import{c as b}from"./copyTextToClipboard-BLtSw0o7.js";import{_ as j}from"./index-CwwL6bPg.js";import{d as E,f,y as g,_ as q,a8 as A,a9 as H,a0 as O,k as w,u as k,ad as W}from"./vue-Bw3NQgLF.js";const N={class:"h-full w-full flex flex-row gap-3"},z=E({name:"CodePreviewModal",__name:"PreviewModal",setup(M){const _=[{key:"java",value:"skill-icons:java-light"},{key:"xml",value:"tabler:file-type-xml"},{key:"sql",value:"carbon:sql"},{key:"ts",value:"skill-icons:typescript"},{key:"vue",value:"logos:vue"},{key:"folder",value:"flat-color-icons:folder"}];function c(e){const t="bx:file",a="flat-color-icons:folder";if(e.endsWith(".vm")){const o=e.slice(0,-3),y=_.find(d=>o.endsWith(d.key));return y?y.value:t}return a}function x(e){const t=[];for(const a of e){let o=t;const y=a.split("/");let d="";for(let r of y){r.endsWith(".vm")?(d+=r,r=r.slice(0,-3)):d+=r+"/";let h=o.find(B=>B.title===r);h||(h={children:[],title:r,key:d,icon:c(d)},o.push(h)),o=h.children}}return t}const i=f(),v=f([]),u=f("左侧选择进行预览"),s=f({}),l=f("代码预览"),[p,{modalLoading:C}]=D(e=>T(this,null,function*(){try{C(!0);const t=yield S(e);s.value=t;const a=x(Object.keys(t));v.value=a,g(()=>{var o;(o=i.value)==null||o.expandAll(!0)})}catch(t){}finally{C(!1)}}));function L(){b(u.value,"复制成功")}const m=f(n.HTML);function I(e){const a=[{type:".ts",mode:n.TYPESCRIPT},{type:".java",mode:n.JAVA},{type:".xml",mode:n.XML},{type:"sql",mode:n.SQL},{type:".vue",mode:n.VUE}].find(o=>e.includes(o.type));a?m.value=a.mode:m.value=n.HTML}function P(e){const[t=""]=e,a=s.value[t];a&&(I(t),u.value=a,l.value="代码预览: "+t.replace(".vm",""))}function R(){u.value="左侧选择进行预览",s.value={},v.value=[],l.value="代码预览",m.value=n.HTML,g(()=>{var e;(e=i.value)==null||e.setSelectedKeys([])})}return(e,t)=>(q(),A(k(F),W(e.$attrs,{okText:"复制代码",title:l.value,canFullscreen:!1,defaultFullscreen:!0,onRegister:k(p),onOk:L,onCancel:R}),{default:H(()=>[O("div",N,[w(k(j),{class:"w-350px h-full",ref_key:"treeRef",ref:i,treeData:v.value,onSelect:P},null,8,["treeData"]),w(k(V),{class:"w-full h-full",value:u.value,mode:m.value,readonly:""},null,8,["value","mode"])])]),_:1},16,["title","onRegister"]))}});export{z as _};
